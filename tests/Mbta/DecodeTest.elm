module Mbta.DecodeTest exposing (suite)

import DecodeHelpers
import Expect
import Json.Decode
import JsonApi
import Mbta exposing (..)
import Mbta.Decode
import Test exposing (..)


testOne : String -> String -> String -> JsonApi.Decoder a -> Test
testOne description url json decoder =
    test description <|
        \() ->
            json
                |> Json.Decode.decodeString (JsonApi.decoderOne decoder)
                |> Expect.ok


testMany : String -> String -> String -> JsonApi.Decoder a -> Test
testMany description url json decoder =
    test description <|
        \() ->
            json
                |> Json.Decode.decodeString (JsonApi.decoderMany decoder)
                |> Expect.ok


suite : Test
suite =
    describe "Mbta.Decode"
        -- Realtime Data
        [ describe "prediction"
            [ testMany
                "plain"
                "https://api-v3.mbta.com/predictions?filter[stop]=place-sstat&filter[direction_id]=0&filter[route]=CR-Worcester,743"
                """
                {"data":[{"attributes":{"arrival_time":null,"departure_time":"2019-05-05T21:59:29-04:00","direction_id":0,"schedule_relationship":null,"status":null,"stop_sequence":1},"id":"prediction-39774969-74611-1","relationships":{"route":{"data":{"id":"743","type":"route"}},"stop":{"data":{"id":"74611","type":"stop"}},"trip":{"data":{"id":"39774969","type":"trip"}}},"type":"prediction"},{"attributes":{"arrival_time":null,"departure_time":"2019-05-05T21:22:26-04:00","direction_id":0,"schedule_relationship":null,"status":null,"stop_sequence":1},"id":"prediction-39774869-74611-1","relationships":{"route":{"data":{"id":"743","type":"route"}},"stop":{"data":{"id":"74611","type":"stop"}},"trip":{"data":{"id":"39774869","type":"trip"}}},"type":"prediction"},{"attributes":{"arrival_time":null,"departure_time":"2019-05-05T21:29:00-04:00","direction_id":0,"schedule_relationship":null,"status":null,"stop_sequence":1},"id":"prediction-39774837-74611-1","relationships":{"route":{"data":{"id":"743","type":"route"}},"stop":{"data":{"id":"74611","type":"stop"}},"trip":{"data":{"id":"39774837","type":"trip"}}},"type":"prediction"},{"attributes":{"arrival_time":null,"departure_time":"2019-05-05T21:44:00-04:00","direction_id":0,"schedule_relationship":null,"status":null,"stop_sequence":1},"id":"prediction-39774815-74611-1","relationships":{"route":{"data":{"id":"743","type":"route"}},"stop":{"data":{"id":"74611","type":"stop"}},"trip":{"data":{"id":"39774815","type":"trip"}}},"type":"prediction"},{"attributes":{"arrival_time":null,"departure_time":"2019-05-05T21:48:38-04:00","direction_id":0,"schedule_relationship":null,"status":null,"stop_sequence":1},"id":"prediction-39774751-74611-1","relationships":{"route":{"data":{"id":"743","type":"route"}},"stop":{"data":{"id":"74611","type":"stop"}},"trip":{"data":{"id":"39774751","type":"trip"}}},"type":"prediction"},{"attributes":{"arrival_time":null,"departure_time":"2019-05-05T21:25:00-04:00","direction_id":0,"schedule_relationship":null,"status":null,"stop_sequence":1},"id":"prediction-39774749-74611-1","relationships":{"route":{"data":{"id":"743","type":"route"}},"stop":{"data":{"id":"74611","type":"stop"}},"trip":{"data":{"id":"39774749","type":"trip"}}},"type":"prediction"},{"attributes":{"arrival_time":null,"departure_time":"2019-05-05T22:40:00-04:00","direction_id":0,"schedule_relationship":null,"status":"On time","stop_sequence":1},"id":"prediction-CR-Sunday-Fall-18-2517-South Station-1","relationships":{"route":{"data":{"id":"CR-Worcester","type":"route"}},"stop":{"data":{"id":"South Station","type":"stop"}},"trip":{"data":{"id":"CR-Sunday-Fall-18-2517","type":"trip"}}},"type":"prediction"}],"jsonapi":{"version":"1.0"}}
                """
                Mbta.Decode.prediction
            , testMany
                "with includes"
                "https://api-v3.mbta.com/predictions?filter[stop]=place-sstat&filter[direction_id]=0&filter[route]=CR-Worcester,743&include=schedule,stop,route,trip,vehicle,alerts"
                """
                {"data":[{"attributes":{"arrival_time":null,"departure_time":"2019-05-05T21:59:29-04:00","direction_id":0,"schedule_relationship":null,"status":null,"stop_sequence":1},"id":"prediction-39774969-74611-1","relationships":{"alerts":{"data":[]},"route":{"data":{"id":"743","type":"route"}},"schedule":{"data":{"id":"schedule-39774969-74611-1","type":"schedule"}},"stop":{"data":{"id":"74611","type":"stop"}},"trip":{"data":{"id":"39774969","type":"trip"}},"vehicle":{"data":null}},"type":"prediction"},{"attributes":{"arrival_time":null,"departure_time":"2019-05-05T21:22:34-04:00","direction_id":0,"schedule_relationship":null,"status":null,"stop_sequence":1},"id":"prediction-39774869-74611-1","relationships":{"alerts":{"data":[]},"route":{"data":{"id":"743","type":"route"}},"schedule":{"data":{"id":"schedule-39774869-74611-1","type":"schedule"}},"stop":{"data":{"id":"74611","type":"stop"}},"trip":{"data":{"id":"39774869","type":"trip"}},"vehicle":{"data":null}},"type":"prediction"},{"attributes":{"arrival_time":null,"departure_time":"2019-05-05T21:29:00-04:00","direction_id":0,"schedule_relationship":null,"status":null,"stop_sequence":1},"id":"prediction-39774837-74611-1","relationships":{"alerts":{"data":[]},"route":{"data":{"id":"743","type":"route"}},"schedule":{"data":{"id":"schedule-39774837-74611-1","type":"schedule"}},"stop":{"data":{"id":"74611","type":"stop"}},"trip":{"data":{"id":"39774837","type":"trip"}},"vehicle":{"data":null}},"type":"prediction"},{"attributes":{"arrival_time":null,"departure_time":"2019-05-05T21:44:00-04:00","direction_id":0,"schedule_relationship":null,"status":null,"stop_sequence":1},"id":"prediction-39774815-74611-1","relationships":{"alerts":{"data":[]},"route":{"data":{"id":"743","type":"route"}},"schedule":{"data":{"id":"schedule-39774815-74611-1","type":"schedule"}},"stop":{"data":{"id":"74611","type":"stop"}},"trip":{"data":{"id":"39774815","type":"trip"}},"vehicle":{"data":null}},"type":"prediction"},{"attributes":{"arrival_time":null,"departure_time":"2019-05-05T21:48:38-04:00","direction_id":0,"schedule_relationship":null,"status":null,"stop_sequence":1},"id":"prediction-39774751-74611-1","relationships":{"alerts":{"data":[]},"route":{"data":{"id":"743","type":"route"}},"schedule":{"data":{"id":"schedule-39774751-74611-1","type":"schedule"}},"stop":{"data":{"id":"74611","type":"stop"}},"trip":{"data":{"id":"39774751","type":"trip"}},"vehicle":{"data":null}},"type":"prediction"},{"attributes":{"arrival_time":null,"departure_time":"2019-05-05T21:25:00-04:00","direction_id":0,"schedule_relationship":null,"status":null,"stop_sequence":1},"id":"prediction-39774749-74611-1","relationships":{"alerts":{"data":[]},"route":{"data":{"id":"743","type":"route"}},"schedule":{"data":{"id":"schedule-39774749-74611-1","type":"schedule"}},"stop":{"data":{"id":"74611","type":"stop"}},"trip":{"data":{"id":"39774749","type":"trip"}},"vehicle":{"data":null}},"type":"prediction"},{"attributes":{"arrival_time":null,"departure_time":"2019-05-05T22:40:00-04:00","direction_id":0,"schedule_relationship":null,"status":"On time","stop_sequence":1},"id":"prediction-CR-Sunday-Fall-18-2517-South Station-1","relationships":{"alerts":{"data":[{"id":"308355","type":"alert"}]},"route":{"data":{"id":"CR-Worcester","type":"route"}},"schedule":{"data":{"id":"schedule-CR-Sunday-Fall-18-2517-South Station-1","type":"schedule"}},"stop":{"data":{"id":"South Station","type":"stop"}},"trip":{"data":{"id":"CR-Sunday-Fall-18-2517","type":"trip"}},"vehicle":{"data":null}},"type":"prediction"}],"included":[{"attributes":{"active_period":[{"end":"2019-05-21T02:30:00-04:00","start":"2019-05-02T14:09:40-04:00"}],"banner":null,"cause":"UNKNOWN_CAUSE","created_at":"2019-05-02T14:14:37-04:00","description":"Affected routes:Greenbush Line","effect":"SCHEDULE_CHANGE","header":"Spring/Summer Commuter Rail schedules go into effect on Monday, May 20th and are now available on the MBTA website at mbta.com.","informed_entity":[{"activities":["BOARD","EXIT","RIDE"],"route":"CR-Fairmount","route_type":2},{"activities":["BOARD","EXIT","RIDE"],"route":"CR-Fitchburg","route_type":2},{"activities":["BOARD","EXIT","RIDE"],"route":"CR-Franklin","route_type":2},{"activities":["BOARD","EXIT","RIDE"],"route":"CR-Greenbush","route_type":2},{"activities":["BOARD","EXIT","RIDE"],"route":"CR-Haverhill","route_type":2},{"activities":["BOARD","EXIT","RIDE"],"route":"CR-Kingston","route_type":2},{"activities":["BOARD","EXIT","RIDE"],"route":"CR-Lowell","route_type":2},{"activities":["BOARD","EXIT","RIDE"],"route":"CR-Middleborough","route_type":2},{"activities":["BOARD","EXIT","RIDE"],"route":"CR-Needham","route_type":2},{"activities":["BOARD","EXIT","RIDE"],"route":"CR-Newburyport","route_type":2},{"activities":["BOARD","EXIT","RIDE"],"route":"CR-Providence","route_type":2},{"activities":["BOARD","EXIT","RIDE"],"route":"CR-Worcester","route_type":2}],"lifecycle":"NEW","service_effect":"Commuter Rail schedule change","severity":1,"short_header":"Spring/Summer Commuter Rail schedules go into effect on Monday, May 20th and are now available on the MBTA website at mbta.com.","timeframe":"through May 20","updated_at":"2019-05-02T14:14:37-04:00","url":null},"id":"308355","links":{"self":"/alerts/308355"},"type":"alert"},{"attributes":{"bikes_allowed":1,"block_id":"S746-77","direction_id":0,"headsign":"Silver Line Way","name":"","wheelchair_accessible":1},"id":"39774749","links":{"self":"/trips/39774749"},"relationships":{"route":{"data":{"id":"746","type":"route"}},"route_pattern":{"data":{"id":"746-_-0","type":"route_pattern"}},"service":{"data":{"id":"BUS22019-hbs29017-Sunday-02","type":"service"}},"shape":{"data":{"id":"7460007","type":"shape"}},"vehicle":{"data":null}},"type":"trip"},{"attributes":{"bikes_allowed":1,"block_id":"S746-77","direction_id":0,"headsign":"Silver Line Way","name":"","wheelchair_accessible":1},"id":"39774751","links":{"self":"/trips/39774751"},"relationships":{"route":{"data":{"id":"746","type":"route"}},"route_pattern":{"data":{"id":"746-_-0","type":"route_pattern"}},"service":{"data":{"id":"BUS22019-hbs29017-Sunday-02","type":"service"}},"shape":{"data":{"id":"7460007","type":"shape"}},"vehicle":{"data":null}},"type":"trip"},{"attributes":{"bikes_allowed":1,"block_id":"S743-76","direction_id":0,"headsign":"Chelsea","name":"","wheelchair_accessible":1},"id":"39774815","links":{"self":"/trips/39774815"},"relationships":{"route":{"data":{"id":"743","type":"route"}},"route_pattern":{"data":{"id":"743-_-0","type":"route_pattern"}},"service":{"data":{"id":"BUS22019-hbs29017-Sunday-02","type":"service"}},"shape":{"data":{"id":"7430008","type":"shape"}},"vehicle":{"data":null}},"type":"trip"},{"attributes":{"bikes_allowed":1,"block_id":"S743-75","direction_id":0,"headsign":"Chelsea","name":"","wheelchair_accessible":1},"id":"39774837","links":{"self":"/trips/39774837"},"relationships":{"route":{"data":{"id":"743","type":"route"}},"route_pattern":{"data":{"id":"743-_-0","type":"route_pattern"}},"service":{"data":{"id":"BUS22019-hbs29017-Sunday-02","type":"service"}},"shape":{"data":{"id":"7430008","type":"shape"}},"vehicle":{"data":null}},"type":"trip"},{"attributes":{"bikes_allowed":1,"block_id":"S743-73","direction_id":0,"headsign":"Chelsea","name":"","wheelchair_accessible":1},"id":"39774869","links":{"self":"/trips/39774869"},"relationships":{"route":{"data":{"id":"743","type":"route"}},"route_pattern":{"data":{"id":"743-_-0","type":"route_pattern"}},"service":{"data":{"id":"BUS22019-hbs29017-Sunday-02","type":"service"}},"shape":{"data":{"id":"7430008","type":"shape"}},"vehicle":{"data":null}},"type":"trip"},{"attributes":{"bikes_allowed":1,"block_id":"S743-68","direction_id":0,"headsign":"Chelsea","name":"","wheelchair_accessible":1},"id":"39774969","links":{"self":"/trips/39774969"},"relationships":{"route":{"data":{"id":"743","type":"route"}},"route_pattern":{"data":{"id":"743-_-0","type":"route_pattern"}},"service":{"data":{"id":"BUS22019-hbs29017-Sunday-02","type":"service"}},"shape":{"data":{"id":"7430008","type":"shape"}},"vehicle":{"data":null}},"type":"trip"},{"attributes":{"color":"7C878E","description":"Key Bus","direction_destinations":["Chelsea","South Station"],"direction_names":["Outbound","Inbound"],"fare_class":"Rapid Transit","long_name":"Chelsea - South Station","short_name":"SL3","sort_order":10053,"text_color":"FFFFFF","type":3},"id":"743","links":{"self":"/routes/743"},"relationships":{"line":{"data":{"id":"line-SLWaterfront","type":"line"}},"route_patterns":{}},"type":"route"},{"attributes":{"address":null,"description":"South Station - Silver Line - Airport/Design Center/Chelsea","latitude":42.352271,"location_type":0,"longitude":-71.055242,"name":"South Station","platform_code":null,"platform_name":"Airport/Design Center/Chelsea","wheelchair_boarding":1},"id":"74611","links":{"self":"/stops/74611"},"relationships":{"child_stops":{},"facilities":{"links":{"related":"/facilities/?filter[stop]=74611"}},"parent_station":{"data":{"id":"place-sstat","type":"stop"}},"recommended_transfers":{},"zone":{"data":null}},"type":"stop"},{"attributes":{"bikes_allowed":1,"block_id":"","direction_id":0,"headsign":"Worcester","name":"2517","wheelchair_accessible":1},"id":"CR-Sunday-Fall-18-2517","links":{"self":"/trips/CR-Sunday-Fall-18-2517"},"relationships":{"route":{"data":{"id":"CR-Worcester","type":"route"}},"route_pattern":{"data":{"id":"CR-Worcester-0-0","type":"route_pattern"}},"service":{"data":{"id":"CR-Sunday-Worcester-Fall-18","type":"service"}},"shape":{"data":{"id":"9850002","type":"shape"}},"vehicle":{"data":null}},"type":"trip"},{"attributes":{"color":"80276C","description":"Commuter Rail","direction_destinations":["Worcester","South Station"],"direction_names":["Outbound","Inbound"],"fare_class":"Commuter Rail","long_name":"Framingham/Worcester Line","short_name":"","sort_order":20003,"text_color":"FFFFFF","type":2},"id":"CR-Worcester","links":{"self":"/routes/CR-Worcester"},"relationships":{"line":{"data":{"id":"line-Worcester","type":"line"}},"route_patterns":{}},"type":"route"},{"attributes":{"address":null,"description":"South Station - Commuter Rail","latitude":42.351763,"location_type":0,"longitude":-71.054797,"name":"South Station","platform_code":null,"platform_name":"Commuter Rail","wheelchair_boarding":1},"id":"South Station","links":{"self":"/stops/South%20Station"},"relationships":{"child_stops":{},"facilities":{"links":{"related":"/facilities/?filter[stop]=South%20Station"}},"parent_station":{"data":{"id":"place-sstat","type":"stop"}},"recommended_transfers":{},"zone":{"data":{"id":"CR-zone-1A","type":"zone"}}},"type":"stop"},{"attributes":{"arrival_time":"2019-05-05T21:25:00-04:00","departure_time":"2019-05-05T21:25:00-04:00","drop_off_type":1,"pickup_type":0,"stop_sequence":1,"timepoint":true},"id":"schedule-39774749-74611-1","relationships":{"prediction":{},"route":{"data":{"id":"746","type":"route"}},"stop":{"data":{"id":"74611","type":"stop"}},"trip":{"data":{"id":"39774749","type":"trip"}}},"type":"schedule"},{"attributes":{"arrival_time":"2019-05-05T21:48:00-04:00","departure_time":"2019-05-05T21:48:00-04:00","drop_off_type":1,"pickup_type":0,"stop_sequence":1,"timepoint":true},"id":"schedule-39774751-74611-1","relationships":{"prediction":{},"route":{"data":{"id":"746","type":"route"}},"stop":{"data":{"id":"74611","type":"stop"}},"trip":{"data":{"id":"39774751","type":"trip"}}},"type":"schedule"},{"attributes":{"arrival_time":"2019-05-05T21:44:00-04:00","departure_time":"2019-05-05T21:44:00-04:00","drop_off_type":1,"pickup_type":0,"stop_sequence":1,"timepoint":true},"id":"schedule-39774815-74611-1","relationships":{"prediction":{},"route":{"data":{"id":"743","type":"route"}},"stop":{"data":{"id":"74611","type":"stop"}},"trip":{"data":{"id":"39774815","type":"trip"}}},"type":"schedule"},{"attributes":{"arrival_time":"2019-05-05T21:29:00-04:00","departure_time":"2019-05-05T21:29:00-04:00","drop_off_type":1,"pickup_type":0,"stop_sequence":1,"timepoint":true},"id":"schedule-39774837-74611-1","relationships":{"prediction":{},"route":{"data":{"id":"743","type":"route"}},"stop":{"data":{"id":"74611","type":"stop"}},"trip":{"data":{"id":"39774837","type":"trip"}}},"type":"schedule"},{"attributes":{"arrival_time":"2019-05-05T21:14:00-04:00","departure_time":"2019-05-05T21:14:00-04:00","drop_off_type":1,"pickup_type":0,"stop_sequence":1,"timepoint":true},"id":"schedule-39774869-74611-1","relationships":{"prediction":{},"route":{"data":{"id":"743","type":"route"}},"stop":{"data":{"id":"74611","type":"stop"}},"trip":{"data":{"id":"39774869","type":"trip"}}},"type":"schedule"},{"attributes":{"arrival_time":"2019-05-05T21:59:00-04:00","departure_time":"2019-05-05T21:59:00-04:00","drop_off_type":1,"pickup_type":0,"stop_sequence":1,"timepoint":true},"id":"schedule-39774969-74611-1","relationships":{"prediction":{},"route":{"data":{"id":"743","type":"route"}},"stop":{"data":{"id":"74611","type":"stop"}},"trip":{"data":{"id":"39774969","type":"trip"}}},"type":"schedule"},{"attributes":{"arrival_time":"2019-05-05T22:40:00-04:00","departure_time":"2019-05-05T22:40:00-04:00","drop_off_type":1,"pickup_type":0,"stop_sequence":1,"timepoint":true},"id":"schedule-CR-Sunday-Fall-18-2517-South Station-1","relationships":{"prediction":{},"route":{"data":{"id":"CR-Worcester","type":"route"}},"stop":{"data":{"id":"South Station","type":"stop"}},"trip":{"data":{"id":"CR-Sunday-Fall-18-2517","type":"trip"}}},"type":"schedule"}],"jsonapi":{"version":"1.0"}}
                """
                Mbta.Decode.prediction
            ]
        , describe "vehicle"
            [ testOne
                "red line vehicle"
                "https://api-v3.mbta.com/vehicles/R-545CFF7A"
                """
                {"data":{"attributes":{"bearing":0.0,"current_status":"INCOMING_AT","current_stop_sequence":200,"direction_id":1,"label":"1713","latitude":42.384159088134766,"longitude":-71.1193618774414,"speed":null,"updated_at":"2019-05-04T21:06:02-04:00"},"id":"R-545CFF7A","links":{"self":"/vehicles/R-545CFF7A"},"relationships":{"route":{"data":{"id":"Red","type":"route"}},"stop":{"data":{"id":"70066","type":"stop"}},"trip":{"data":{"id":"40120241-L","type":"trip"}}},"type":"vehicle"},"jsonapi":{"version":"1.0"}}
                """
                Mbta.Decode.vehicle
            , testOne
                "red line vehicle with includes"
                "https://api-v3.mbta.com/vehicles/R-545CFF7A?include=trip,stop,route"
                """
                {"data":{"attributes":{"bearing":355.0,"current_status":"INCOMING_AT","current_stop_sequence":210,"direction_id":1,"label":"1713","latitude":42.39231872558594,"longitude":-71.11897277832031,"speed":null,"updated_at":"2019-05-04T21:08:08-04:00"},"id":"R-545CFF7A","links":{"self":"/vehicles/R-545CFF7A"},"relationships":{"route":{"data":{"id":"Red","type":"route"}},"stop":{"data":{"id":"70064","type":"stop"}},"trip":{"data":{"id":"40120241-L","type":"trip"}}},"type":"vehicle"},"included":[{"attributes":{"bikes_allowed":0,"block_id":"S933_-15-1-L0","direction_id":1,"headsign":"Alewife","name":"","wheelchair_accessible":1},"id":"40120241-L","links":{"self":"/trips/40120241-L"},"relationships":{"route":{"data":{"id":"Red","type":"route"}},"route_pattern":{"data":{"id":"Red-3-1","type":"route_pattern"}},"service":{"data":{"id":"RTL22019-hms29016-Saturday-01-L","type":"service"}},"shape":{"data":{"id":"933_0010","type":"shape"}}},"type":"trip"},{"attributes":{"address":null,"description":"Davis - Red Line - Alewife","latitude":42.39674,"location_type":0,"longitude":-71.121815,"name":"Davis","platform_code":null,"platform_name":"Alewife","wheelchair_boarding":1},"id":"70064","links":{"self":"/stops/70064"},"relationships":{"child_stops":{},"facilities":{"links":{"related":"/facilities/?filter[stop]=70064"}},"parent_station":{"data":{"id":"place-davis","type":"stop"}},"recommended_transfers":{},"zone":{"data":null}},"type":"stop"},{"attributes":{"color":"DA291C","description":"Rapid Transit","direction_destinations":["Ashmont/Braintree","Alewife"],"direction_names":["South","North"],"fare_class":"Rapid Transit","long_name":"Red Line","short_name":"","sort_order":10010,"text_color":"FFFFFF","type":1},"id":"Red","links":{"self":"/routes/Red"},"relationships":{"line":{"data":{"id":"line-Red","type":"line"}},"route_patterns":{}},"type":"route"}],"jsonapi":{"version":"1.0"}}
                """
                Mbta.Decode.vehicle
            , testOne
                "bus"
                "https://api-v3.mbta.com/vehicles/y1909"
                """
                {"data":{"attributes":{"bearing":304.0,"current_status":"IN_TRANSIT_TO","current_stop_sequence":19,"direction_id":0,"label":"1909","latitude":42.36564254760742,"longitude":-71.10411071777344,"speed":null,"updated_at":"2019-05-04T21:09:42-04:00"},"id":"y1909","links":{"self":"/vehicles/y1909"},"relationships":{"route":{"data":{"id":"1","type":"route"}},"stop":{"data":{"id":"102","type":"stop"}},"trip":{"data":{"id":"40023953","type":"trip"}}},"type":"vehicle"},"jsonapi":{"version":"1.0"}}
                """
                Mbta.Decode.vehicle
            , testOne
                "commuter rail"
                "https://api-v3.mbta.com/vehicles/1823"
                """
                {"data":{"attributes":{"bearing":69.0,"current_status":"STOPPED_AT","current_stop_sequence":6,"direction_id":1,"label":"1823","latitude":42.275909423828125,"longitude":-71.42063903808594,"speed":2.0,"updated_at":"2019-05-04T21:11:37-04:00"},"id":"1823","links":{"self":"/vehicles/1823"},"relationships":{"route":{"data":{"id":"CR-Worcester","type":"route"}},"stop":{"data":{"id":"Framingham","type":"stop"}},"trip":{"data":{"id":"CR-Saturday-Fall-18-1514","type":"trip"}}},"type":"vehicle"},"jsonapi":{"version":"1.0"}}
                """
                Mbta.Decode.vehicle
            , testMany
                "multiple"
                "https://api-v3.mbta.com/vehicles?filter[route]=83,CR-Worcester,Green-B,Orange"
                """
                {"data":[{"attributes":{"bearing":41.0,"current_status":"IN_TRANSIT_TO","current_stop_sequence":2,"direction_id":1,"label":"0733","latitude":42.365882873535156,"longitude":-71.1036376953125,"speed":null,"updated_at":"2019-05-04T21:43:16-04:00"},"id":"y0733","links":{"self":"/vehicles/y0733"},"relationships":{"route":{"data":{"id":"83","type":"route"}},"stop":{"data":{"id":"2446","type":"stop"}},"trip":{"data":{"id":"40169635","type":"trip"}}},"type":"vehicle"},{"attributes":{"bearing":72.0,"current_status":"IN_TRANSIT_TO","current_stop_sequence":15,"direction_id":1,"label":"1823","latitude":42.35514831542969,"longitude":-71.19261932373047,"speed":21.0,"updated_at":"2019-05-04T21:42:39-04:00"},"id":"1823","links":{"self":"/vehicles/1823"},"relationships":{"route":{"data":{"id":"CR-Worcester","type":"route"}},"stop":{"data":{"id":"Boston Landing","type":"stop"}},"trip":{"data":{"id":"CR-Saturday-Fall-18-1514","type":"trip"}}},"type":"vehicle"},{"attributes":{"bearing":329.0,"current_status":"IN_TRANSIT_TO","current_stop_sequence":18,"direction_id":0,"label":"1807","latitude":42.259639739990234,"longitude":-71.76171875,"speed":10.0,"updated_at":"2019-05-04T21:42:30-04:00"},"id":"1807","links":{"self":"/vehicles/1807"},"relationships":{"route":{"data":{"id":"CR-Worcester","type":"route"}},"stop":{"data":{"id":"Worcester","type":"stop"}},"trip":{"data":{"id":"CR-Saturday-Fall-18-1515","type":"trip"}}},"type":"vehicle"},{"attributes":{"bearing":45.0,"current_status":"INCOMING_AT","current_stop_sequence":50,"direction_id":1,"label":"3835-3618","latitude":42.34186935424805,"longitude":-71.14505767822266,"speed":null,"updated_at":"2019-05-04T21:43:13-04:00"},"id":"G-10192","links":{"self":"/vehicles/G-10192"},"relationships":{"route":{"data":{"id":"Green-B","type":"route"}},"stop":{"data":{"id":"70120","type":"stop"}},"trip":{"data":{"id":"ADDED-1556895997","type":"trip"}}},"type":"vehicle"},{"attributes":{"bearing":215.0,"current_status":"STOPPED_AT","current_stop_sequence":40,"direction_id":0,"label":"3815-3605","latitude":42.35988998413086,"longitude":-71.05896759033203,"speed":null,"updated_at":"2019-05-04T21:42:52-04:00"},"id":"G-10133","links":{"self":"/vehicles/G-10133"},"relationships":{"route":{"data":{"id":"Green-B","type":"route"}},"stop":{"data":{"id":"70202","type":"stop"}},"trip":{"data":{"id":"ADDED-1556895950","type":"trip"}}},"type":"vehicle"},{"attributes":{"bearing":270.0,"current_status":"IN_TRANSIT_TO","current_stop_sequence":310,"direction_id":0,"label":"3714-3875","latitude":42.34016036987305,"longitude":-71.16393280029297,"speed":null,"updated_at":"2019-05-04T21:43:10-04:00"},"id":"G-10125","links":{"self":"/vehicles/G-10125"},"relationships":{"route":{"data":{"id":"Green-B","type":"route"}},"stop":{"data":{"id":"70107","type":"stop"}},"trip":{"data":{"id":"ADDED-1556896004","type":"trip"}}},"type":"vehicle"},{"attributes":{"bearing":90.0,"current_status":"IN_TRANSIT_TO","current_stop_sequence":560,"direction_id":1,"label":"3826-3712","latitude":42.34893035888672,"longitude":-71.0944595336914,"speed":null,"updated_at":"2019-05-04T21:43:16-04:00"},"id":"G-10111","links":{"self":"/vehicles/G-10111"},"relationships":{"route":{"data":{"id":"Green-B","type":"route"}},"stop":{"data":{"id":"70152","type":"stop"}},"trip":{"data":{"id":"ADDED-1556895959","type":"trip"}}},"type":"vehicle"},{"attributes":{"bearing":45.0,"current_status":"INCOMING_AT","current_stop_sequence":100,"direction_id":1,"label":"3699-3849","latitude":42.35063171386719,"longitude":-71.1303482055664,"speed":null,"updated_at":"2019-05-04T21:43:17-04:00"},"id":"G-10098","links":{"self":"/vehicles/G-10098"},"relationships":{"route":{"data":{"id":"Green-B","type":"route"}},"stop":{"data":{"id":"70134","type":"stop"}},"trip":{"data":{"id":"ADDED-1556895990","type":"trip"}}},"type":"vehicle"},{"attributes":{"bearing":270.0,"current_status":"INCOMING_AT","current_stop_sequence":310,"direction_id":0,"label":"3881-3651","latitude":42.34006118774414,"longitude":-71.1658706665039,"speed":null,"updated_at":"2019-05-04T21:42:01-04:00"},"id":"G-10092","links":{"self":"/vehicles/G-10092"},"relationships":{"route":{"data":{"id":"Green-B","type":"route"}},"stop":{"data":{"id":"70107","type":"stop"}},"trip":{"data":{"id":"ADDED-1556895934","type":"trip"}}},"type":"vehicle"},{"attributes":{"bearing":130.0,"current_status":"INCOMING_AT","current_stop_sequence":560,"direction_id":1,"label":"3696-3845","latitude":42.348140716552734,"longitude":-71.09221649169922,"speed":null,"updated_at":"2019-05-04T21:42:27-04:00"},"id":"G-10090","links":{"self":"/vehicles/G-10090"},"relationships":{"route":{"data":{"id":"Green-B","type":"route"}},"stop":{"data":{"id":"70152","type":"stop"}},"trip":{"data":{"id":"ADDED-1556896008","type":"trip"}}},"type":"vehicle"},{"attributes":{"bearing":90.0,"current_status":"INCOMING_AT","current_stop_sequence":550,"direction_id":1,"label":"3631-3862","latitude":42.34886169433594,"longitude":-71.095947265625,"speed":null,"updated_at":"2019-05-04T21:43:13-04:00"},"id":"G-10089","links":{"self":"/vehicles/G-10089"},"relationships":{"route":{"data":{"id":"Green-B","type":"route"}},"stop":{"data":{"id":"71150","type":"stop"}},"trip":{"data":{"id":"ADDED-1556895967","type":"trip"}}},"type":"vehicle"},{"attributes":{"bearing":225.0,"current_status":"INCOMING_AT","current_stop_sequence":230,"direction_id":0,"label":"3890","latitude":42.349571228027344,"longitude":-71.13288879394531,"speed":null,"updated_at":"2019-05-04T21:37:53-04:00"},"id":"G-10086","links":{"self":"/vehicles/G-10086"},"relationships":{"route":{"data":{"id":"Green-B","type":"route"}},"stop":{"data":{"id":"70129","type":"stop"}},"trip":{"data":{"id":"ADDED-1556895915","type":"trip"}}},"type":"vehicle"},{"attributes":{"bearing":75.0,"current_status":"STOPPED_AT","current_stop_sequence":310,"direction_id":0,"label":"3610-3848","latitude":42.340999603271484,"longitude":-71.16741943359375,"speed":null,"updated_at":"2019-05-04T21:40:26-04:00"},"id":"G-10078","links":{"self":"/vehicles/G-10078"},"relationships":{"route":{"data":{"id":"Green-B","type":"route"}},"stop":{"data":{"id":"70107","type":"stop"}},"trip":{"data":{"id":"ADDED-1556895922","type":"trip"}}},"type":"vehicle"},{"attributes":{"bearing":315.0,"current_status":"INCOMING_AT","current_stop_sequence":180,"direction_id":0,"label":"3653-3852","latitude":42.35108947753906,"longitude":-71.11544799804688,"speed":null,"updated_at":"2019-05-04T21:42:46-04:00"},"id":"G-10070","links":{"self":"/vehicles/G-10070"},"relationships":{"route":{"data":{"id":"Green-B","type":"route"}},"stop":{"data":{"id":"70141","type":"stop"}},"trip":{"data":{"id":"ADDED-1556895927","type":"trip"}}},"type":"vehicle"},{"attributes":{"bearing":315.0,"current_status":"STOPPED_AT","current_stop_sequence":140,"direction_id":0,"label":"3641-3825","latitude":42.34925079345703,"longitude":-71.10008239746094,"speed":null,"updated_at":"2019-05-04T21:43:06-04:00"},"id":"G-10061","links":{"self":"/vehicles/G-10061"},"relationships":{"route":{"data":{"id":"Green-B","type":"route"}},"stop":{"data":{"id":"70149","type":"stop"}},"trip":{"data":{"id":"ADDED-1556895939","type":"trip"}}},"type":"vehicle"},{"attributes":{"bearing":135.0,"current_status":"INCOMING_AT","current_stop_sequence":140,"direction_id":1,"label":"3856-3649","latitude":42.35100173950195,"longitude":-71.11506652832031,"speed":null,"updated_at":"2019-05-04T21:42:14-04:00"},"id":"G-10051","links":{"self":"/vehicles/G-10051"},"relationships":{"route":{"data":{"id":"Green-B","type":"route"}},"stop":{"data":{"id":"70142","type":"stop"}},"trip":{"data":{"id":"ADDED-1556895980","type":"trip"}}},"type":"vehicle"},{"attributes":{"bearing":315.0,"current_status":"INCOMING_AT","current_stop_sequence":150,"direction_id":0,"label":"3644-3821","latitude":42.349578857421875,"longitude":-71.10282897949219,"speed":null,"updated_at":"2019-05-04T21:43:06-04:00"},"id":"G-10036","links":{"self":"/vehicles/G-10036"},"relationships":{"route":{"data":{"id":"Green-B","type":"route"}},"stop":{"data":{"id":"70147","type":"stop"}},"trip":{"data":{"id":"ADDED-1556895944","type":"trip"}}},"type":"vehicle"},{"attributes":{"bearing":90.0,"current_status":"IN_TRANSIT_TO","current_stop_sequence":10,"direction_id":1,"label":"3861-3675","latitude":42.339988708496094,"longitude":-71.16583251953125,"speed":null,"updated_at":"2019-05-04T21:43:15-04:00"},"id":"G-10022","links":{"self":"/vehicles/G-10022"},"relationships":{"route":{"data":{"id":"Green-B","type":"route"}},"stop":{"data":{"id":"70110","type":"stop"}},"trip":{"data":{"id":"ADDED-1556896007","type":"trip"}}},"type":"vehicle"},{"attributes":{"bearing":205.0,"current_status":"INCOMING_AT","current_stop_sequence":180,"direction_id":0,"label":"1263","latitude":42.31393814086914,"longitude":-71.10574340820313,"speed":null,"updated_at":"2019-05-04T21:43:18-04:00"},"id":"O-545D00FC","links":{"self":"/vehicles/O-545D00FC"},"relationships":{"route":{"data":{"id":"Orange","type":"route"}},"stop":{"data":{"id":"70002","type":"stop"}},"trip":{"data":{"id":"39786384","type":"trip"}}},"type":"vehicle"},{"attributes":{"bearing":230.0,"current_status":"INCOMING_AT","current_stop_sequence":120,"direction_id":0,"label":"1316","latitude":42.34762954711914,"longitude":-71.06733703613281,"speed":null,"updated_at":"2019-05-04T21:42:58-04:00"},"id":"O-545D0097","links":{"self":"/vehicles/O-545D0097"},"relationships":{"route":{"data":{"id":"Orange","type":"route"}},"stop":{"data":{"id":"70014","type":"stop"}},"trip":{"data":{"id":"39786385","type":"trip"}}},"type":"vehicle"},{"attributes":{"bearing":30.0,"current_status":"INCOMING_AT","current_stop_sequence":10,"direction_id":1,"label":"1286","latitude":42.30540084838867,"longitude":-71.11077117919922,"speed":null,"updated_at":"2019-05-04T21:43:06-04:00"},"id":"O-545D003B","links":{"self":"/vehicles/O-545D003B"},"relationships":{"route":{"data":{"id":"Orange","type":"route"}},"stop":{"data":{"id":"70003","type":"stop"}},"trip":{"data":{"id":"39786401","type":"trip"}}},"type":"vehicle"},{"attributes":{"bearing":20.0,"current_status":"INCOMING_AT","current_stop_sequence":180,"direction_id":1,"label":"1220","latitude":42.4227294921875,"longitude":-71.075927734375,"speed":null,"updated_at":"2019-05-04T21:43:06-04:00"},"id":"O-545CFF75","links":{"self":"/vehicles/O-545CFF75"},"relationships":{"route":{"data":{"id":"Orange","type":"route"}},"stop":{"data":{"id":"70035","type":"stop"}},"trip":{"data":{"id":"39786417","type":"trip"}}},"type":"vehicle"},{"attributes":{"bearing":185.0,"current_status":"IN_TRANSIT_TO","current_stop_sequence":10,"direction_id":0,"label":"1311","latitude":42.43463897705078,"longitude":-71.07131958007813,"speed":null,"updated_at":"2019-05-04T21:43:06-04:00"},"id":"O-545CFF74","links":{"self":"/vehicles/O-545CFF74"},"relationships":{"route":{"data":{"id":"Orange","type":"route"}},"stop":{"data":{"id":"70034","type":"stop"}},"trip":{"data":{"id":"39786387","type":"trip"}}},"type":"vehicle"},{"attributes":{"bearing":320.0,"current_status":"INCOMING_AT","current_stop_sequence":140,"direction_id":1,"label":"1236","latitude":42.371429443359375,"longitude":-71.06597137451172,"speed":null,"updated_at":"2019-05-04T21:42:43-04:00"},"id":"O-545CFF70","links":{"self":"/vehicles/O-545CFF70"},"relationships":{"route":{"data":{"id":"Orange","type":"route"}},"stop":{"data":{"id":"70029","type":"stop"}},"trip":{"data":{"id":"39786420","type":"trip"}}},"type":"vehicle"},{"attributes":{"bearing":40.0,"current_status":"INCOMING_AT","current_stop_sequence":70,"direction_id":1,"label":"1222","latitude":42.34571075439453,"longitude":-71.07814025878906,"speed":null,"updated_at":"2019-05-04T21:43:02-04:00"},"id":"O-545CFC98","links":{"self":"/vehicles/O-545CFC98"},"relationships":{"route":{"data":{"id":"Orange","type":"route"}},"stop":{"data":{"id":"70015","type":"stop"}},"trip":{"data":{"id":"39786423","type":"trip"}}},"type":"vehicle"},{"attributes":{"bearing":150.0,"current_status":"INCOMING_AT","current_stop_sequence":50,"direction_id":0,"label":"1314","latitude":42.37736129760742,"longitude":-71.0750503540039,"speed":null,"updated_at":"2019-05-04T21:43:01-04:00"},"id":"O-545CF044","links":{"self":"/vehicles/O-545CF044"},"relationships":{"route":{"data":{"id":"Orange","type":"route"}},"stop":{"data":{"id":"70028","type":"stop"}},"trip":{"data":{"id":"39786386","type":"trip"}}},"type":"vehicle"}],"jsonapi":{"version":"1.0"}}
                """
                Mbta.Decode.vehicle
            ]

        -- Schedule Data
        , describe "route"
            [ testOne
                "bus"
                "/routes/741"
                """
                {"data":{"attributes":{"color":"7C878E","description":"Key Bus","direction_destinations":["Logan Airport","South Station"],"direction_names":["Outbound","Inbound"],"fare_class":"Rapid Transit","long_name":"Logan Airport - South Station","short_name":"SL1","sort_order":10051,"text_color":"FFFFFF","type":3},"id":"741","links":{"self":"/routes/741"},"relationships":{"line":{"data":{"id":"line-SLWaterfront","type":"line"}},"route_patterns":{}},"type":"route"},"jsonapi":{"version":"1.0"}}
                """
                Mbta.Decode.route
            , testOne
                "subway"
                "/routes/Blue"
                """
                {"data":{"attributes":{"color":"003DA5","description":"Rapid Transit","direction_destinations":["Bowdoin","Wonderland"],"direction_names":["West","East"],"fare_class":"Rapid Transit","long_name":"Blue Line","short_name":"","sort_order":10040,"text_color":"FFFFFF","type":1},"id":"Blue","links":{"self":"/routes/Blue"},"relationships":{"line":{"data":{"id":"line-Blue","type":"line"}},"route_patterns":{}},"type":"route"},"jsonapi":{"version":"1.0"}}
                """
                Mbta.Decode.route
            , testOne
                "commuter rail"
                "/routes/CR-Franklin"
                """
                {"data":{"attributes":{"color":"80276C","description":"Commuter Rail","direction_destinations":["Forge Park/495","South Station"],"direction_names":["Outbound","Inbound"],"fare_class":"Commuter Rail","long_name":"Franklin Line","short_name":"","sort_order":20004,"text_color":"FFFFFF","type":2},"id":"CR-Franklin","links":{"self":"/routes/CR-Franklin"},"relationships":{"line":{"data":{"id":"line-Franklin","type":"line"}},"route_patterns":{}},"type":"route"},"jsonapi":{"version":"1.0"}}
                """
                Mbta.Decode.route
            , testOne
                "ferry"
                "/routes/Boat-F1"
                """
                {"data":{"attributes":{"color":"008EAA","description":"Ferry","direction_destinations":["Hingham or Hull","Long Wharf"],"direction_names":["Outbound","Inbound"],"fare_class":"Ferry","long_name":"Hingham/Hull Ferry","short_name":"","sort_order":30002,"text_color":"FFFFFF","type":4},"id":"Boat-F1","links":{"self":"/routes/Boat-F1"},"relationships":{"line":{"data":null},"route_patterns":{}},"type":"route"},"jsonapi":{"version":"1.0"}}
                """
                Mbta.Decode.route
            , testOne
                "with include"
                "/routes/116?include=line,route_patterns"
                """
                {"data":{"attributes":{"color":"FFC72C","description":"Key Bus","direction_destinations":["Wonderland","Maverick"],"direction_names":["Outbound","Inbound"],"fare_class":"Local Bus","long_name":"Wonderland - Maverick via Revere Street","short_name":"116","sort_order":51160,"text_color":"000000","type":3},"id":"116","links":{"self":"/routes/116"},"relationships":{"line":{"data":{"id":"line-114116117","type":"line"}},"route_patterns":{"data":[{"id":"116-4-0","type":"route_pattern"},{"id":"116-4-1","type":"route_pattern"},{"id":"116-9-0","type":"route_pattern"}]}},"type":"route"},"included":[{"attributes":{"direction_id":0,"name":"Wonderland Station via Revere Street","sort_order":51160000,"time_desc":null,"typicality":1},"id":"116-4-0","links":{"self":"/route-patterns/116-4-0"},"relationships":{"representative_trip":{"data":{"id":"40100493","type":"trip"}},"route":{"data":{"id":"116","type":"route"}}},"type":"route_pattern"},{"attributes":{"direction_id":1,"name":"Maverick via Revere","sort_order":51160100,"time_desc":null,"typicality":1},"id":"116-4-1","links":{"self":"/route-patterns/116-4-1"},"relationships":{"representative_trip":{"data":{"id":"40100744","type":"trip"}},"route":{"data":{"id":"116","type":"route"}}},"type":"route_pattern"},{"attributes":{"direction_id":0,"name":"Wonderland Station via Revere Street","sort_order":51160099,"time_desc":"Sunday early mornings only","typicality":3},"id":"116-9-0","links":{"self":"/route-patterns/116-9-0"},"relationships":{"representative_trip":{"data":{"id":"40080148","type":"trip"}},"route":{"data":{"id":"116","type":"route"}}},"type":"route_pattern"},{"attributes":{"color":"FFC72C","long_name":"Wonderland or Chelsea - Maverick","short_name":"114/116/117","sort_order":51140,"text_color":"000000"},"id":"line-114116117","links":{"self":"/lines/line-114116117"},"relationships":{"routes":{}},"type":"line"}],"jsonapi":{"version":"1.0"}}
                """
                Mbta.Decode.route
            , testMany
                "many with include"
                "/routes?filter[stop]=place-state"
                """
                {"data":[{"attributes":{"color":"ED8B00","description":"Rapid Transit","direction_destinations":["Forest Hills","Oak Grove"],"direction_names":["South","North"],"fare_class":"Rapid Transit","long_name":"Orange Line","short_name":"","sort_order":10020,"text_color":"FFFFFF","type":1},"id":"Orange","links":{"self":"/routes/Orange"},"relationships":{"line":{"data":{"id":"line-Orange","type":"line"}},"route_patterns":{}},"type":"route"},{"attributes":{"color":"003DA5","description":"Rapid Transit","direction_destinations":["Bowdoin","Wonderland"],"direction_names":["West","East"],"fare_class":"Rapid Transit","long_name":"Blue Line","short_name":"","sort_order":10040,"text_color":"FFFFFF","type":1},"id":"Blue","links":{"self":"/routes/Blue"},"relationships":{"line":{"data":{"id":"line-Blue","type":"line"}},"route_patterns":{}},"type":"route"},{"attributes":{"color":"FFC72C","description":"Commuter Bus","direction_destinations":["North Burlington","Downtown Boston"],"direction_names":["Outbound","Inbound"],"fare_class":"Outer Express","long_name":"North Burlington - Downtown Boston","short_name":"352","sort_order":53520,"text_color":"000000","type":3},"id":"352","links":{"self":"/routes/352"},"relationships":{"line":{"data":{"id":"line-352","type":"line"}},"route_patterns":{}},"type":"route"},{"attributes":{"color":"FFC72C","description":"Commuter Bus","direction_destinations":["Burlington","Downtown Boston"],"direction_names":["Outbound","Inbound"],"fare_class":"Outer Express","long_name":"Burlington - Downtown Boston","short_name":"354","sort_order":53540,"text_color":"000000","type":3},"id":"354","links":{"self":"/routes/354"},"relationships":{"line":{"data":{"id":"line-354","type":"line"}},"route_patterns":{}},"type":"route"}],"jsonapi":{"version":"1.0"}}
                """
                Mbta.Decode.route
            ]
        , describe "routePattern"
            [ testOne
                "one"
                "https://api-v3.mbta.com/route-patterns/Boat-F1-0-0"
                """
                {"data":{"attributes":{"direction_id":0,"name":"Long Wharf - Hingham via Logan Airport & Hull","sort_order":30002000,"time_desc":null,"typicality":1},"id":"Boat-F1-0-0","links":{"self":"/route-patterns/Boat-F1-0-0"},"relationships":{"representative_trip":{"data":{"id":"Boat-F1-1100-Long-Weekday","type":"trip"}},"route":{"data":{"id":"Boat-F1","type":"route"}}},"type":"route_pattern"},"jsonapi":{"version":"1.0"}}
                """
                Mbta.Decode.routePattern

            {-
               disabled due to bug in api. https://app.asana.com/0/695227265423458/1121247532991446
               , testOne
                   "with includes"
                   "https://api-v3.mbta.com/route-patterns/Boat-F1-0-0?include=route,representative_trip"
                   """
                   {"data":{"attributes":{"direction_id":0,"name":"Long Wharf - Hingham via Logan Airport & Hull","sort_order":30002000,"time_desc":null,"typicality":1},"id":"Boat-F1-0-0","links":{"self":"/route-patterns/Boat-F1-0-0"},"relationships":{"representative_trip":{"data":[{"id":"Boat-F1-1100-Long-Weekday","type":"trip"}]},"route":{"data":{"id":"Boat-F1","type":"route"}}},"type":"route_pattern"},"included":[{"attributes":{"color":"008EAA","description":"Ferry","direction_destinations":["Hingham or Hull","Long Wharf"],"direction_names":["Outbound","Inbound"],"fare_class":"Ferry","long_name":"Hingham/Hull Ferry","short_name":"","sort_order":30002,"text_color":"FFFFFF","type":4},"id":"Boat-F1","links":{"self":"/routes/Boat-F1"},"relationships":{"line":{"data":null},"route_patterns":{}},"type":"route"},{"attributes":{"bikes_allowed":1,"block_id":"B-08","direction_id":0,"headsign":"Hingham via Logan Airport & Hull","name":"","wheelchair_accessible":1},"id":"Boat-F1-1100-Long-Weekday","links":{"self":"/trips/Boat-F1-1100-Long-Weekday"},"relationships":{"route":{"data":{"id":"Boat-F1","type":"route"}},"route_pattern":{"data":{"id":"Boat-F1-0-0","type":"route_pattern"}},"service":{"data":{"id":"Boat-F1-Weekday","type":"service"}},"shape":{"data":{"id":"b0006","type":"shape"}}},"type":"trip"}],"jsonapi":{"version":"1.0"}}
                   """
                   Mbta.Decode.routePattern
            -}
            , testMany
                "multiple"
                "https://api-v3.mbta.com/route-patterns?filter[route]=225&filter[direction_id]=1"
                """
                {"data":[{"attributes":{"direction_id":1,"name":"Quincy Center","sort_order":52250167,"time_desc":null,"typicality":2},"id":"225-1-1","links":{"self":"/route-patterns/225-1-1"},"relationships":{"representative_trip":{"data":{"id":"39991847","type":"trip"}},"route":{"data":{"id":"225","type":"route"}}},"type":"route_pattern"},{"attributes":{"direction_id":1,"name":"Quincy Center via Shaw Street","sort_order":52250175,"time_desc":null,"typicality":2},"id":"225-4-1","links":{"self":"/route-patterns/225-4-1"},"relationships":{"representative_trip":{"data":{"id":"39991872","type":"trip"}},"route":{"data":{"id":"225","type":"route"}}},"type":"route_pattern"},{"attributes":{"direction_id":1,"name":"Quincy Center","sort_order":52250181,"time_desc":null,"typicality":2},"id":"225-3-1","links":{"self":"/route-patterns/225-3-1"},"relationships":{"representative_trip":{"data":{"id":"39991942","type":"trip"}},"route":{"data":{"id":"225","type":"route"}}},"type":"route_pattern"},{"attributes":{"direction_id":1,"name":"Quincy Center via Quincy Avenue","sort_order":52250190,"time_desc":null,"typicality":3},"id":"225-_-1","links":{"self":"/route-patterns/225-_-1"},"relationships":{"representative_trip":{"data":{"id":"39991901","type":"trip"}},"route":{"data":{"id":"225","type":"route"}}},"type":"route_pattern"},{"attributes":{"direction_id":1,"name":"Quincy Center via Shaw Street","sort_order":52250190,"time_desc":null,"typicality":3},"id":"225-5-1","links":{"self":"/route-patterns/225-5-1"},"relationships":{"representative_trip":{"data":{"id":"39991849","type":"trip"}},"route":{"data":{"id":"225","type":"route"}}},"type":"route_pattern"},{"attributes":{"direction_id":1,"name":"Quincy Center via Shaw Street","sort_order":52250194,"time_desc":"Weekdays only","typicality":3},"id":"225-2-1","links":{"self":"/route-patterns/225-2-1"},"relationships":{"representative_trip":{"data":{"id":"39991866","type":"trip"}},"route":{"data":{"id":"225","type":"route"}}},"type":"route_pattern"}],"jsonapi":{"version":"1.0"}}
                """
                Mbta.Decode.routePattern
            ]
        , describe "lines"
            [ testOne
                "one"
                "https://api-v3.mbta.com/lines/line-SLWaterfront"
                """
                {"data":{"attributes":{"color":"7C878E","long_name":"Silver Line SL1/SL2/SL3","short_name":"","sort_order":10051,"text_color":"FFFFFF"},"id":"line-SLWaterfront","links":{"self":"/lines/line-SLWaterfront"},"relationships":{"routes":{}},"type":"line"},"jsonapi":{"version":"1.0"}}
                """
                Mbta.Decode.line
            , testOne
                "with includes"
                "https://api-v3.mbta.com/lines/line-SLWaterfront?include=routes"
                """
                {"data":{"attributes":{"color":"7C878E","long_name":"Silver Line SL1/SL2/SL3","short_name":"","sort_order":10051,"text_color":"FFFFFF"},"id":"line-SLWaterfront","links":{"self":"/lines/line-SLWaterfront"},"relationships":{"routes":{"data":[{"id":"741","type":"route"},{"id":"742","type":"route"},{"id":"743","type":"route"},{"id":"746","type":"route"}]}},"type":"line"},"included":[{"attributes":{"color":"7C878E","description":"Key Bus","direction_destinations":["Logan Airport","South Station"],"direction_names":["Outbound","Inbound"],"fare_class":"Rapid Transit","long_name":"Logan Airport - South Station","short_name":"SL1","sort_order":10051,"text_color":"FFFFFF","type":3},"id":"741","links":{"self":"/routes/741"},"relationships":{"line":{"data":{"id":"line-SLWaterfront","type":"line"}},"route_patterns":{}},"type":"route"},{"attributes":{"color":"7C878E","description":"Key Bus","direction_destinations":["Design Center","South Station"],"direction_names":["Outbound","Inbound"],"fare_class":"Rapid Transit","long_name":"Design Center - South Station","short_name":"SL2","sort_order":10052,"text_color":"FFFFFF","type":3},"id":"742","links":{"self":"/routes/742"},"relationships":{"line":{"data":{"id":"line-SLWaterfront","type":"line"}},"route_patterns":{}},"type":"route"},{"attributes":{"color":"7C878E","description":"Key Bus","direction_destinations":["Chelsea","South Station"],"direction_names":["Outbound","Inbound"],"fare_class":"Rapid Transit","long_name":"Chelsea - South Station","short_name":"SL3","sort_order":10053,"text_color":"FFFFFF","type":3},"id":"743","links":{"self":"/routes/743"},"relationships":{"line":{"data":{"id":"line-SLWaterfront","type":"line"}},"route_patterns":{}},"type":"route"},{"attributes":{"color":"7C878E","description":"Key Bus","direction_destinations":["Silver Line Way","South Station"],"direction_names":["Outbound","Inbound"],"fare_class":"Rapid Transit","long_name":"Silver Line Way - South Station","short_name":"","sort_order":10057,"text_color":"FFFFFF","type":3},"id":"746","links":{"self":"/routes/746"},"relationships":{"line":{"data":{"id":"line-SLWaterfront","type":"line"}},"route_patterns":{}},"type":"route"}],"jsonapi":{"version":"1.0"}}
                """
                Mbta.Decode.line
            , testMany
                "multiple"
                "https://api-v3.mbta.com/lines?filter[id]=line-SLWaterfront,line-Green"
                """
                {"data":[{"attributes":{"color":"00843D","long_name":"Green Line","short_name":"","sort_order":10032,"text_color":"FFFFFF"},"id":"line-Green","links":{"self":"/lines/line-Green"},"relationships":{"routes":{}},"type":"line"},{"attributes":{"color":"7C878E","long_name":"Silver Line SL1/SL2/SL3","short_name":"","sort_order":10051,"text_color":"FFFFFF"},"id":"line-SLWaterfront","links":{"self":"/lines/line-SLWaterfront"},"relationships":{"routes":{}},"type":"line"}],"jsonapi":{"version":"1.0"}}
                """
                Mbta.Decode.line
            ]
        , describe "schedule"
            [ testMany
                "plain"
                "https://api-v3.mbta.com/schedules?filter[route]=743&filter[stop]=place-aport&filter[min_time]=24:00&filter[max_time]=24:20"
                """
                {"data":[{"attributes":{"arrival_time":"2019-05-06T00:13:00-04:00","departure_time":"2019-05-06T00:13:00-04:00","drop_off_type":0,"pickup_type":0,"stop_sequence":5,"timepoint":false},"id":"schedule-39774855-7096-5","relationships":{"prediction":{},"route":{"data":{"id":"743","type":"route"}},"stop":{"data":{"id":"7096","type":"stop"}},"trip":{"data":{"id":"39774855","type":"trip"}}},"type":"schedule"},{"attributes":{"arrival_time":"2019-05-06T00:11:00-04:00","departure_time":"2019-05-06T00:11:00-04:00","drop_off_type":0,"pickup_type":0,"stop_sequence":5,"timepoint":false},"id":"schedule-39774951-7097-5","relationships":{"prediction":{},"route":{"data":{"id":"743","type":"route"}},"stop":{"data":{"id":"7097","type":"stop"}},"trip":{"data":{"id":"39774951","type":"trip"}}},"type":"schedule"}],"jsonapi":{"version":"1.0"}}
                """
                Mbta.Decode.schedule
            , testMany
                "with includes"
                "https://api-v3.mbta.com/schedules?filter[route]=743&filter[stop]=place-aport&filter[min_time]=24:00&filter[max_time]=24:20?include=stop,trip,prediction,route"
                """
                {"data":[{"attributes":{"arrival_time":"2019-05-06T00:13:00-04:00","departure_time":"2019-05-06T00:13:00-04:00","drop_off_type":0,"pickup_type":0,"stop_sequence":5,"timepoint":false},"id":"schedule-39774855-7096-5","relationships":{"prediction":{"data":null},"route":{"data":{"id":"743","type":"route"}},"stop":{"data":{"id":"7096","type":"stop"}},"trip":{"data":{"id":"39774855","type":"trip"}}},"type":"schedule"},{"attributes":{"arrival_time":"2019-05-06T00:11:00-04:00","departure_time":"2019-05-06T00:11:00-04:00","drop_off_type":0,"pickup_type":0,"stop_sequence":5,"timepoint":false},"id":"schedule-39774951-7097-5","relationships":{"prediction":{"data":null},"route":{"data":{"id":"743","type":"route"}},"stop":{"data":{"id":"7097","type":"stop"}},"trip":{"data":{"id":"39774951","type":"trip"}}},"type":"schedule"}],"included":[{"attributes":{"bikes_allowed":1,"block_id":"S743-75","direction_id":0,"headsign":"Chelsea","name":"","wheelchair_accessible":1},"id":"39774855","links":{"self":"/trips/39774855"},"relationships":{"route":{"data":{"id":"743","type":"route"}},"route_pattern":{"data":{"id":"743-_-0","type":"route_pattern"}},"service":{"data":{"id":"BUS22019-hbs29017-Sunday-02","type":"service"}},"shape":{"data":{"id":"7430008","type":"shape"}}},"type":"trip"},{"attributes":{"bikes_allowed":1,"block_id":"S743-68","direction_id":1,"headsign":"South Station","name":"","wheelchair_accessible":1},"id":"39774951","links":{"self":"/trips/39774951"},"relationships":{"route":{"data":{"id":"743","type":"route"}},"route_pattern":{"data":{"id":"743-_-1","type":"route_pattern"}},"service":{"data":{"id":"BUS22019-hbs29017-Sunday-02","type":"service"}},"shape":{"data":{"id":"7430009","type":"shape"}}},"type":"trip"},{"attributes":{"address":null,"description":"Airport - Silver Line - SL3 Chelsea","latitude":42.374693,"location_type":0,"longitude":-71.029333,"name":"Airport","platform_code":"B","platform_name":"Chelsea","wheelchair_boarding":1},"id":"7096","links":{"self":"/stops/7096"},"relationships":{"child_stops":{},"facilities":{"links":{"related":"/facilities/?filter[stop]=7096"}},"parent_station":{"data":{"id":"place-aport","type":"stop"}},"recommended_transfers":{},"zone":{"data":null}},"type":"stop"},{"attributes":{"address":null,"description":"Airport - Silver Line - SL3 South Station","latitude":42.374518,"location_type":0,"longitude":-71.029532,"name":"Airport","platform_code":"A","platform_name":"South Station","wheelchair_boarding":1},"id":"7097","links":{"self":"/stops/7097"},"relationships":{"child_stops":{},"facilities":{"links":{"related":"/facilities/?filter[stop]=7097"}},"parent_station":{"data":{"id":"place-aport","type":"stop"}},"recommended_transfers":{},"zone":{"data":null}},"type":"stop"},{"attributes":{"color":"7C878E","description":"Key Bus","direction_destinations":["Chelsea","South Station"],"direction_names":["Outbound","Inbound"],"fare_class":"Rapid Transit","long_name":"Chelsea - South Station","short_name":"SL3","sort_order":10053,"text_color":"FFFFFF","type":3},"id":"743","links":{"self":"/routes/743"},"relationships":{"line":{"data":{"id":"line-SLWaterfront","type":"line"}},"route_patterns":{}},"type":"route"}],"jsonapi":{"version":"1.0"}}
                """
                Mbta.Decode.schedule
            ]
        , describe "trip"
            [ testOne
                "one trip"
                "https://api-v3.mbta.com/trips/CR-Saturday-Fall-18-1515"
                """
                {"data":{"attributes":{"bikes_allowed":1,"block_id":"","direction_id":0,"headsign":"Worcester","name":"1515","wheelchair_accessible":1},"id":"CR-Saturday-Fall-18-1515","links":{"self":"/trips/CR-Saturday-Fall-18-1515"},"relationships":{"route":{"data":{"id":"CR-Worcester","type":"route"}},"route_pattern":{"data":{"id":"CR-Worcester-0-0","type":"route_pattern"}},"service":{"data":{"id":"CR-Saturday-Worcester-Fall-18","type":"service"}},"shape":{"data":{"id":"9850002","type":"shape"}}},"type":"trip"},"jsonapi":{"version":"1.0"}}
                """
                Mbta.Decode.trip
            , testOne
                "with includes"
                "https://api-v3.mbta.com/trips/CR-Saturday-Fall-18-1515?include=route,vehicle,service,shape,predictions,route_pattern"
                """
                {"data":{"attributes":{"bikes_allowed":1,"block_id":"","direction_id":0,"headsign":"Worcester","name":"1515","wheelchair_accessible":1},"id":"CR-Saturday-Fall-18-1515","links":{"self":"/trips/CR-Saturday-Fall-18-1515"},"relationships":{"predictions":{"data":[{"id":"prediction-CR-Saturday-Fall-18-1515-Worcester-18","type":"prediction"}]},"route":{"data":{"id":"CR-Worcester","type":"route"}},"route_pattern":{"data":{"id":"CR-Worcester-0-0","type":"route_pattern"}},"service":{"data":{"id":"CR-Saturday-Worcester-Fall-18","type":"service"}},"shape":{"data":{"id":"9850002","type":"shape"}},"vehicle":{"data":{"id":"1807","type":"vehicle"}}},"type":"trip"},"included":[{"attributes":{"bearing":250.0,"current_status":"IN_TRANSIT_TO","current_stop_sequence":18,"direction_id":0,"label":"1807","latitude":42.26298904418945,"longitude":-71.78627014160156,"speed":7.0,"updated_at":"2019-05-04T21:47:14-04:00"},"id":"1807","links":{"self":"/vehicles/1807"},"relationships":{"route":{"data":{"id":"CR-Worcester","type":"route"}},"stop":{"data":{"id":"Worcester","type":"stop"}},"trip":{"data":{"id":"CR-Saturday-Fall-18-1515","type":"trip"}}},"type":"vehicle"},{"attributes":{"direction_id":0,"name":"Worcester","polyline":"{wnaGh}tpLzPdHbA`@`Bp@PFn@Z^Nh@Xd@Xb@ZPN\\\\h@d@z@d@`ARj@Jn@Hf@@h@@p@Ab@Cd@O|ACHEZG^EXEXCLCLIl@c@dD]nBKp@CVu@|EEVERa@hCMbAG`@CRK~@e@fGSnCEd@E|A?ZAh@AtA@dCAbD@\\\\?`@@zFAj@?n@?rA?R???jA?ZDlC@XD~ABbA@f@@tI@lDFhBBzCHz`@@V?jEBbC@fA?p@Ch@GlAMzBMtAChA?fF@zAAnC?V@V?V?pF@zF?rQ@T?t@BrA?fCAnBCtACf@???JGj@Gp@Er@C\\\\{A~N}A`OANAJ[zB]jBWnA[jAY~@GTELGNmCrGQ\\\\EFWl@Sf@ELUn@g@hAm@rAi@xAqBtFADg@fA{AtDcCzFg@dAc@x@q@vBS|@u@jD[jBSfBa@vF_@pEQfCqCf_@QhCc@|F[bDKl@Cl@IrAALU`D}@pLWjDc@hGSpDANCRQ`Dg@rGKdBa@hDKrAGhAQxB]xEUvCGdAGdACdAC~A?tBDjB@X@L?HF~AFbAZdEJ|AHnAFvBFtCF|E@pC?FLlGBzBDrF@rBB|CFdHLdI@~AFfFFdEJ`KBjDNtM?zAAvBEdACfAIxAGdAK|@KdAQpAKn@QfASrASxA]hDQtCGfBAlB?zA@nAFzBFrAHlAPbBd@pDBV@Pl@vEb@lDHd@DZNpAFVBPBRp@pFBPlBxND^D\\\\@DDZjAnJDZFZ\\\\rChBfNh@vD^xB^nBj@bDLp@BLDPf@fCNn@RhAjBrJ\\\\`B`AdFP|@BPBJ~@rE`@zBX~Ar@`FZfCPxAFv@??BTBd@F`@NjBr@lJR~CBVBXFfAd@xG|@rMNnBV`C`@bDnBlNThBrApJRbBf@lFJ~ALrBHlB?VBPZpIBP?N\\\\lI@X@VDj@ZfHD|@??Bn@FhB@Z@L?LBXH~ALzCR~EH~A@R@TV`GRfFVrFr@lQ@L?H@N@P@P@\\\\FdAVlGRzD\\\\|H@RBZJ~C@D??LdDHdAFz@NlAN`ALx@Jj@VhA\\\\rAV~@Xv@Xr@DJFP\\\\v@h@fA`BhCfAnAf@d@h@f@ZZ\\\\XVTTRjA~@rCbC`@\\\\xArAdAdAhAnApA|AdAvAtAvBr@pAJRDHZr@fAjCDNL\\\\X~@v@zChAfFbA~EtAfGp@~Cp@zCd@rBh@fB^hAXt@\\\\x@r@rAp@jAt@fAf@r@~@bAh@f@p@p@j@d@dAt@r@`@n@\\\\x@^RFh@RlA\\\\tATVD`ALdAFtA@hAC~COfGc@vCUrEYzAEtA?nBHfAJd@BH?J@fARhAVvDbAJD??jGfBnBj@vBj@vCz@PFLDbFxAxA^bElAnBj@lA^jD`AtI~BPDRDRFt@T~@XVFRFv@Tx@X??LDrAn@r@b@dAr@bAx@dB~Ad@p@FHFLt@hAnCdEzFxIfAdBtDtFfAbBhAhBxEdHvAvBj@z@DFFJ~CxE|@tAlBrC|EnHbBdClBtCv@nAhAtBv@|AXp@f@bB??ZfADRBHf@pBTfA`@fCVtBV`DLpBBxB@L?R@tDQtOAbEGtBIvFIfI?hEFxFZzKL~BRzCXjD^rDp@xEr@~Dp@|CVlAVlAh@~BVvA`CjLb@bBpA~DnCpHbCxGjBxE~BvG`BjF~DlNfB`GbCpInA|Et@fDb@tB@JBPn@`Ef@pDb@bEVdDPfC^nFZ|Dz@hK@PB`@??VhD@HF|@@TBb@LrC`@vFf@rGPpCLbB`@nGZxCVlBp@dE~A`Lh@fEPhCF~AFbD@`CCnBI|AIdA[dFOnBMrBUrCUfG?pBAzB@fCDxCFnCLnGLjJBlDDnEHxDF~ELdHHtEBpEJvFV~SJ`GHfGFjDDrC@r@@d@?J@H@j@BhA@L??PjCP~BR|AdA~Fx@fEj@~BVlAvD`Rx@rDj@vCzAdHVfB~@nE^vB^rCRtAx@hG|@fHn@dE^fDpA~JnArI`@xDZnDVnBRnA`@xBjAhG??ZdB~@fFn@bDX|ARnALlAJpBJ~BFlBHdEBjBAN@PFjD@`BFtDF`EJ`GBbCHlEHbGPxIBpA@N@NLxBRlBTpBXhBTnA`@bB`@tAb@xAh@xAt@hBv@`Br@lAd@r@r@`Al@p@v@r@xBtBpApAnB`BfAbA^Xt@b@|@l@rA|@xBlAd@Td@VrBz@xAp@|B~@nBx@rCvAz@f@ZR^Zv@j@fC`Cr@t@`@h@|@jAj@z@^r@p@nAbBxD^dADFBFFV^lAj@|BRj@d@`C^pCXnCRtBH`BD`BBjA@bA?fCCpBCfAYpIg@vMs@`S?FSpFK~CIzAOzDY~GYzH_@|Ju@fS[nI[`I??ANInCAHALi@tNY`IAd@Ab@InBQdCIz@K~@QhAWrAi@`CyA`GgC~J{BpIaB|GUbAOn@_@tBIh@c@xDGv@QdEArACrA@dBLjK@~BAzBCbBEbAQ`CKjAUhBSrAIf@Mt@Qr@q@nC}BxIy@bDs@fDSbAQlA[vCOdBG|@Ez@ErBAnA?xBBzAHnBH|AT~BP~ApAfLb@xD??P~AZxCN|ADj@Dt@Bf@P|FV|HLpEpArc@?D@PBfA@`A|Atg@FnD@~CCnAExAGhAShCIv@g@pDS`AmAhFi@|ByBbJ}@hECLCJGXUvAm@jEQpAc@vEQpBKdBSnEIlDClCAj@?\\\\?RAb@Af@ErDSfRAT?RAbA?P?TmAxhASrSEtCG~KAtJMp`AGh\\\\?tHAtBE~AE|AOnBSxBS~AYdB[dBc@dBc@~Ag@|AaAbCiEjKoAvDa@nAQp@_AdD}@`EQ|@CL_@nBs@hEGl@YzBWbCQxBYdEI`BGhBErBGzD?rD@rAHlEFbBV|EBT??@TBd@JvAd@fF`@nDXrBrB~OdBrMJv@DVdA`IdAlItBnOnA|JBL?DBNFf@Jl@nAjJjBxN??XvBh@jD\\\\vB`@rBXlADP^zAb@bB\\\\lA`@nAd@rAx@vBn@zAj@jAvAnCXh@V^`AvAh@r@z@hAlBzBvA|AxFpGzA`BpC`DXX\\\\^fDxDlBzBfAlAbEdExFxGnEnFp@hArDtIpFbLtJzOrBpCtBjDvBnDrBxEp@tAf@zBv@hEr@jE\\\\zDX`EVlAv@xDZfAf@nA`@z@x@|Ad@x@tAzB@@T\\\\FJXd@d@x@??~BzDtBlDt@|AZx@Tl@^dAPt@VjARbARtANdB`ApQp@rM\\\\rHf@fJb@rH^pHp@dKLhAJrAFp@Lz@XbCRnARlAx@bE\\\\bBz@pDdAzDp@nBl@dB~A|DxBvFBHJTfErKhB|Et@vBz@nCb@nAt@rCf@lBTdAn@~Ct@`E^~Bh@pDTfBLjAt@nI`@nGz@vNPvChAtQLbCRpDL~BP`CP`DVbFH`AJrBDr@Dx@FfBB~@BnB?nAA`AKzBEh@MnAOhAQ`AIb@c@hBQl@M^e@lAO\\\\]r@aAbB]j@a@h@_AlAe@f@g@f@aA|@o@f@{@l@wAz@yAx@kAl@_A`@yAj@OF_Bf@cAXa@H}@NaBPmBN}@F}F\\\\cYdBiALoARg@J{@Ry@V{@Xq@VeBt@u@\\\\iB`A}Ax@m@`@o@`@}AlA{@r@sBhBeE`E_FxEq@r@w@~@[`@Yb@s@hAs@pA]p@gBrDkA|Bu@nAiAfBo@z@o@z@o@t@SV}@`Ai@f@uAhAa@Zi@`@g@Zo@^cB|@yAp@m@Vk@Pk@PuA^i@Ji@Hs@Hu@Fs@Bq@@q@@q@?sBGoHe@uAEWAs@EY@_@DYDc@Fc@JcAXa@L_@P{@b@]R_@VYTa@^YZ[Zo@z@m@|@U`@Sb@Ud@Qb@_@hA]hAKf@WnASjAMhAMrAGpAGjA?RARApAApA@f@@l@HxAJlAFf@Hf@TlAVhARr@`@jAXr@^t@PZbAzAz@hAb@l@lF|GpDlEx@fAjA`B@?bBhCzDxHr@tAdFhJj@bA~@bBj@dA^x@d@hA\\\\bA`@zATjAP|@RvAXbCfBdPh@`EJf@zAbIXrAR`ABNb@jBNj@DN","priority":2},"id":"9850002","links":{"self":"/shapes/9850002"},"relationships":{"route":{"data":{"id":"CR-Worcester","type":"route"}},"stops":{"data":[{"id":"place-sstat","type":"stop"},{"id":"place-bbsta","type":"stop"},{"id":"Yawkey","type":"stop"},{"id":"Boston Landing","type":"stop"},{"id":"Newtonville","type":"stop"},{"id":"West Newton","type":"stop"},{"id":"Auburndale","type":"stop"},{"id":"Wellesley Farms","type":"stop"},{"id":"Wellesley Hills","type":"stop"},{"id":"Wellesley Square","type":"stop"},{"id":"Natick Center","type":"stop"},{"id":"West Natick","type":"stop"},{"id":"Framingham","type":"stop"},{"id":"Ashland","type":"stop"},{"id":"Southborough","type":"stop"},{"id":"Westborough","type":"stop"},{"id":"Grafton","type":"stop"},{"id":"Worcester","type":"stop"}]}},"type":"shape"},{"attributes":{"added_dates":["2019-04-27"],"added_dates_notes":[null],"description":"Saturday schedule","end_date":"2019-05-19","removed_dates":["2019-05-11","2019-05-18"],"removed_dates_notes":[null,null],"schedule_name":"Saturday","schedule_type":"Saturday","schedule_typicality":1,"start_date":"2019-04-25","valid_days":[6]},"id":"CR-Saturday-Worcester-Fall-18","links":{"self":"/services/CR-Saturday-Worcester-Fall-18"},"type":"service"},{"attributes":{"color":"80276C","description":"Commuter Rail","direction_destinations":["Worcester","South Station"],"direction_names":["Outbound","Inbound"],"fare_class":"Commuter Rail","long_name":"Framingham/Worcester Line","short_name":"","sort_order":20003,"text_color":"FFFFFF","type":2},"id":"CR-Worcester","links":{"self":"/routes/CR-Worcester"},"relationships":{"line":{"data":{"id":"line-Worcester","type":"line"}},"route_patterns":{}},"type":"route"},{"attributes":{"direction_id":0,"name":"South Station - Worcester","sort_order":20003000,"time_desc":null,"typicality":1},"id":"CR-Worcester-0-0","links":{"self":"/route-patterns/CR-Worcester-0-0"},"relationships":{"representative_trip":{"data":{"id":"CR-Weekday-Fall-18-501","type":"trip"}},"route":{"data":{"id":"CR-Worcester","type":"route"}}},"type":"route_pattern"},{"attributes":{"arrival_time":"2019-05-04T21:49:07-04:00","departure_time":null,"direction_id":0,"schedule_relationship":null,"status":null,"stop_sequence":18},"id":"prediction-CR-Saturday-Fall-18-1515-Worcester-18","relationships":{"route":{"data":{"id":"CR-Worcester","type":"route"}},"stop":{"data":{"id":"Worcester","type":"stop"}},"trip":{"data":{"id":"CR-Saturday-Fall-18-1515","type":"trip"}},"vehicle":{"data":{"id":"1807","type":"vehicle"}}},"type":"prediction"}],"jsonapi":{"version":"1.0"}}
                """
                Mbta.Decode.trip
            , testMany
                "multiple"
                "https://api-v3.mbta.com/trips?filter[route]=170&filter[date]=2019-05-03"
                """
                {"data":[{"attributes":{"bikes_allowed":1,"block_id":"A170-44","direction_id":0,"headsign":"Waltham Central Square (Express)","name":"","wheelchair_accessible":1},"id":"39984476","links":{"self":"/trips/39984476"},"relationships":{"route":{"data":{"id":"170","type":"route"}},"route_pattern":{"data":{"id":"170-_-0","type":"route_pattern"}},"service":{"data":{"id":"BUS22019-hba29011-Weekday-02","type":"service"}},"shape":{"data":{"id":"1700028","type":"shape"}}},"type":"trip"},{"attributes":{"bikes_allowed":1,"block_id":"A170-43","direction_id":0,"headsign":"Waltham Central Square (Express)","name":"","wheelchair_accessible":1},"id":"39984509","links":{"self":"/trips/39984509"},"relationships":{"route":{"data":{"id":"170","type":"route"}},"route_pattern":{"data":{"id":"170-_-0","type":"route_pattern"}},"service":{"data":{"id":"BUS22019-hba29011-Weekday-02","type":"service"}},"shape":{"data":{"id":"1700028","type":"shape"}}},"type":"trip"},{"attributes":{"bikes_allowed":1,"block_id":"A170-45","direction_id":1,"headsign":"Dudley (Express)","name":"","wheelchair_accessible":1},"id":"39984813","links":{"self":"/trips/39984813"},"relationships":{"route":{"data":{"id":"170","type":"route"}},"route_pattern":{"data":{"id":"170-3-1","type":"route_pattern"}},"service":{"data":{"id":"BUS22019-hba29011-Weekday-02","type":"service"}},"shape":{"data":{"id":"1700033","type":"shape"}}},"type":"trip"},{"attributes":{"bikes_allowed":1,"block_id":"A170-46","direction_id":1,"headsign":"Dudley (Express)","name":"","wheelchair_accessible":1},"id":"39984814","links":{"self":"/trips/39984814"},"relationships":{"route":{"data":{"id":"170","type":"route"}},"route_pattern":{"data":{"id":"170-3-1","type":"route_pattern"}},"service":{"data":{"id":"BUS22019-hba29011-Weekday-02","type":"service"}},"shape":{"data":{"id":"1700033","type":"shape"}}},"type":"trip"}],"jsonapi":{"version":"1.0"}}
                """
                Mbta.Decode.trip
            ]
        , describe "service"
            [ testOne
                "one"
                "https://api-v3.mbta.com/services/CR-Weekday-Greenbush-Fall-18"
                """
                {"data":{"attributes":{"added_dates":["2019-04-25","2019-04-26","2019-04-29","2019-04-30","2019-05-01"],"added_dates_notes":[null,null,null,null,null],"description":"Weekday schedule","end_date":"2019-05-19","removed_dates":[],"removed_dates_notes":[],"schedule_name":"Weekday","schedule_type":"Weekday","schedule_typicality":1,"start_date":"2019-04-25","valid_days":[1,2,3,4,5]},"id":"CR-Weekday-Greenbush-Fall-18","links":{"self":"/services/CR-Weekday-Greenbush-Fall-18"},"type":"service"},"jsonapi":{"version":"1.0"}}
                """
                Mbta.Decode.service
            , testMany
                "many"
                "https://api-v3.mbta.com/services?filter[id]=BUS22019-hbq29hl7-Sunday-02,BUS22019-hbc29hl7-Sunday-02"
                """
                {"data":[{"attributes":{"added_dates":["2019-05-27"],"added_dates_notes":["Memorial Day"],"description":"Holiday (Sunday schedule)","end_date":"2019-05-27","removed_dates":[],"removed_dates_notes":[],"schedule_name":"Holiday","schedule_type":"Sunday","schedule_typicality":3,"start_date":"2019-05-27","valid_days":[7]},"id":"BUS22019-hbq29hl7-Sunday-02","links":{"self":"/services/BUS22019-hbq29hl7-Sunday-02"},"type":"service"},{"attributes":{"added_dates":["2019-05-27"],"added_dates_notes":["Memorial Day"],"description":"Holiday (Sunday schedule)","end_date":"2019-05-27","removed_dates":[],"removed_dates_notes":[],"schedule_name":"Holiday","schedule_type":"Sunday","schedule_typicality":3,"start_date":"2019-05-27","valid_days":[7]},"id":"BUS22019-hbc29hl7-Sunday-02","links":{"self":"/services/BUS22019-hbc29hl7-Sunday-02"},"type":"service"}],"jsonapi":{"version":"1.0"}}
                """
                Mbta.Decode.service
            ]
        , describe "shape"
            [ testOne
                "one"
                "https://api-v3.mbta.com/shapes/931_0009"
                """
                {"data":{"attributes":{"direction_id":0,"name":"Ashmont","polyline":"}nwaG~|eqLGyNIqAAc@S_CAEWu@g@}@u@k@u@Wu@OMGIMISQkAOcAGw@SoDFkCf@sUXcJJuERwHPkENqCJmB^mDn@}D??D[TeANy@\\\\iAt@qB`AwBl@cAl@m@b@Yn@QrBEtCKxQ_ApMT??R?`m@hD`Np@jAF|@C`B_@hBi@n@s@d@gA`@}@Z_@RMZIl@@fBFlB\\\\tAP??~@L^?HCLKJWJ_@vC{NDGLQvG}HdCiD`@e@Xc@b@oAjEcPrBeGfAsCvMqVl@sA??jByD`DoGd@cAj@cBJkAHqBNiGXeHVmJr@kR~@q^HsB@U??NgDr@gJTcH`@aMFyCF}AL}DN}GL}CXkILaD@QFmA@[??DaAFiBDu@BkA@UB]Fc@Jo@BGJ_@Lc@\\\\}@vJ_OrCyDj@iAb@_AvBuF`@gA`@aAv@qBVo@Xu@??bDgI??Tm@~IsQj@cAr@wBp@kBj@kB??HWtDcN`@g@POl@UhASh@Eb@?t@FXHl@Px@b@he@h[pCC??bnAm@h@T??xF|BpBp@^PLBXAz@Yl@]l@e@|B}CT[p@iA|A}BZi@zDuF\\\\c@n@s@VObAw@^Sl@Yj@U\\\\O|@WdAUxAQRCt@E??xAGrBQZAhAGlAEv@Et@E~@AdAAbCGpCA|BEjCMr@?nBDvANlARdBb@nDbA~@XnBp@\\\\JRH??|Al@`AZbA^jA^lA\\\\h@P|@TxAZ|@J~@LN?fBXxHhApDt@b@JXFtAVhALx@FbADtAC`B?z@BHBH@|@f@RN^^T\\\\h@hANb@HZH`@H^LpADlA@dD@jD@x@@b@Bp@HdAFd@Ll@F^??n@rDBRl@vD^pATp@Rb@b@z@\\\\l@`@j@p@t@j@h@n@h@n@`@hAh@n@\\\\t@PzANpAApBGtE}@xBa@??xB_@nOmB`OgBb@IrC[p@MbEmARCV@d@LH?tDyAXM","priority":2},"id":"931_0009","links":{"self":"/shapes/931_0009"},"relationships":{"route":{"data":{"id":"Red","type":"route"}},"stops":{"data":[{"id":"place-alfcl","type":"stop"},{"id":"place-davis","type":"stop"},{"id":"place-portr","type":"stop"},{"id":"place-harsq","type":"stop"},{"id":"place-cntsq","type":"stop"},{"id":"place-knncl","type":"stop"},{"id":"place-chmnl","type":"stop"},{"id":"place-pktrm","type":"stop"},{"id":"place-dwnxg","type":"stop"},{"id":"place-sstat","type":"stop"},{"id":"place-brdwy","type":"stop"},{"id":"place-andrw","type":"stop"},{"id":"place-jfk","type":"stop"},{"id":"place-shmnl","type":"stop"},{"id":"place-fldcr","type":"stop"},{"id":"place-smmnl","type":"stop"},{"id":"place-asmnl","type":"stop"}]}},"type":"shape"},"jsonapi":{"version":"1.0"}}
                """
                Mbta.Decode.shape
            , testOne
                "with includes"
                "https://api-v3.mbta.com/shapes/7460007?include=route,stops"
                """
                {"data":{"attributes":{"direction_id":0,"name":"Silver Line Way","polyline":"y~naGj~tpLYo@Wu@Us@a@kAWiAMq@KqAEaB?uCPeBjAoOT_Cn@_C@E??j@aBpD_K`@u@RY\\\\[pAaAHCbGc@r@]h@o@d@e@b@m@`@eAFS??tC_Kt@yBNm@Fq@Au@?o@?}@","priority":3},"id":"7460007","links":{"self":"/shapes/7460007"},"relationships":{"route":{"data":{"id":"746","type":"route"}},"stops":{"data":[{"id":"place-sstat","type":"stop"},{"id":"place-crtst","type":"stop"},{"id":"place-wtcst","type":"stop"},{"id":"74624","type":"stop"}]}},"type":"shape"},"included":[{"attributes":{"color":"7C878E","description":"Key Bus","direction_destinations":["Silver Line Way","South Station"],"direction_names":["Outbound","Inbound"],"fare_class":"Rapid Transit","long_name":"Silver Line Way - South Station","short_name":"","sort_order":10057,"text_color":"FFFFFF","type":3},"id":"746","links":{"self":"/routes/746"},"relationships":{"line":{"data":{"id":"line-SLWaterfront","type":"line"}},"route_patterns":{}},"type":"route"},{"attributes":{"address":"Silver Line Way and Starboard Way, Boston, MA 02210","description":"Silver Line Way after Manulife Building - Silver Line - Airport/Design Center/Chelsea","latitude":42.347056,"location_type":0,"longitude":-71.038814,"name":"Silver Line Way after Manulife Building","platform_code":null,"platform_name":"Airport/Design Center/Chelsea","wheelchair_boarding":1},"id":"74624","links":{"self":"/stops/74624"},"relationships":{"child_stops":{},"facilities":{"links":{"related":"/facilities/?filter[stop]=74624"}},"parent_station":{"data":null},"recommended_transfers":{},"zone":{"data":null}},"type":"stop"},{"attributes":{"address":"Seaport Blvd and Pittsburg St, Boston, MA","description":null,"latitude":42.35245,"location_type":1,"longitude":-71.04685,"name":"Courthouse","platform_code":null,"platform_name":null,"wheelchair_boarding":1},"id":"place-crtst","links":{"self":"/stops/place-crtst"},"relationships":{"child_stops":{},"facilities":{"links":{"related":"/facilities/?filter[stop]=place-crtst"}},"parent_station":{"data":null},"recommended_transfers":{},"zone":{"data":null}},"type":"stop"},{"attributes":{"address":"700 Atlantic Ave, Boston, MA 02110","description":null,"latitude":42.352271,"location_type":1,"longitude":-71.055242,"name":"South Station","platform_code":null,"platform_name":null,"wheelchair_boarding":1},"id":"place-sstat","links":{"self":"/stops/place-sstat"},"relationships":{"child_stops":{},"facilities":{"links":{"related":"/facilities/?filter[stop]=place-sstat"}},"parent_station":{"data":null},"recommended_transfers":{},"zone":{"data":{"id":"CR-zone-1A","type":"zone"}}},"type":"stop"},{"attributes":{"address":"Congress St and World Trade Center Ave, Boston, MA","description":null,"latitude":42.34863,"location_type":1,"longitude":-71.04246,"name":"World Trade Center","platform_code":null,"platform_name":null,"wheelchair_boarding":1},"id":"place-wtcst","links":{"self":"/stops/place-wtcst"},"relationships":{"child_stops":{},"facilities":{"links":{"related":"/facilities/?filter[stop]=place-wtcst"}},"parent_station":{"data":null},"recommended_transfers":{},"zone":{"data":null}},"type":"stop"}],"jsonapi":{"version":"1.0"}}
                """
                Mbta.Decode.shape
            , testMany
                "multiple"
                "https://api-v3.mbta.com/shapes?filter[route]=Red,filter[direction_id]=0"
                """
                {"data":[{"attributes":{"direction_id":0,"name":"Ashmont","polyline":"}nwaG~|eqLGyNIqAAc@S_CAEWu@g@}@u@k@u@Wu@OMGIMISQkAOcAGw@SoDFkCf@sUXcJJuERwHPkENqCJmB^mDn@}D??D[TeANy@\\\\iAt@qB`AwBl@cAl@m@b@Yn@QrBEtCKxQ_ApMT??R?`m@hD`Np@jAF|@C`B_@hBi@n@s@d@gA`@}@Z_@RMZIl@@fBFlB\\\\tAP??~@L^?HCLKJWJ_@vC{NDGLQvG}HdCiD`@e@Xc@b@oAjEcPrBeGfAsCvMqVl@sA??jByD`DoGd@cAj@cBJkAHqBNiGXeHVmJr@kR~@q^HsB@U??NgDr@gJTcH`@aMFyCF}AL}DN}GL}CXkILaD@QFmA@[??DaAFiBDu@BkA@UB]Fc@Jo@BGJ_@Lc@\\\\}@vJ_OrCyDj@iAb@_AvBuF`@gA`@aAv@qBVo@Xu@??bDgI??Tm@~IsQj@cAr@wBp@kBj@kB??HWtDcN`@g@POl@UhASh@Eb@?t@FXHl@Px@b@he@h[pCC??bnAm@h@T??xF|BpBp@^PLBXAz@Yl@]l@e@|B}CT[p@iA|A}BZi@zDuF\\\\c@n@s@VObAw@^Sl@Yj@U\\\\O|@WdAUxAQRCt@E??xAGrBQZAhAGlAEv@Et@E~@AdAAbCGpCA|BEjCMr@?nBDvANlARdBb@nDbA~@XnBp@\\\\JRH??|Al@`AZbA^jA^lA\\\\h@P|@TxAZ|@J~@LN?fBXxHhApDt@b@JXFtAVhALx@FbADtAC`B?z@BHBH@|@f@RN^^T\\\\h@hANb@HZH`@H^LpADlA@dD@jD@x@@b@Bp@HdAFd@Ll@F^??n@rDBRl@vD^pATp@Rb@b@z@\\\\l@`@j@p@t@j@h@n@h@n@`@hAh@n@\\\\t@PzANpAApBGtE}@xBa@??xB_@nOmB`OgBb@IrC[p@MbEmARCV@d@LH?tDyAXM","priority":2},"id":"931_0009","links":{"self":"/shapes/931_0009"},"relationships":{"route":{"data":{"id":"Red","type":"route"}},"stops":{"data":[{"id":"place-alfcl","type":"stop"},{"id":"place-davis","type":"stop"},{"id":"place-portr","type":"stop"},{"id":"place-harsq","type":"stop"},{"id":"place-cntsq","type":"stop"},{"id":"place-knncl","type":"stop"},{"id":"place-chmnl","type":"stop"},{"id":"place-pktrm","type":"stop"},{"id":"place-dwnxg","type":"stop"},{"id":"place-sstat","type":"stop"},{"id":"place-brdwy","type":"stop"},{"id":"place-andrw","type":"stop"},{"id":"place-jfk","type":"stop"},{"id":"place-shmnl","type":"stop"},{"id":"place-fldcr","type":"stop"},{"id":"place-smmnl","type":"stop"},{"id":"place-asmnl","type":"stop"}]}},"type":"shape"},{"attributes":{"direction_id":1,"name":"Ashmont","polyline":"qsaaGfrvpLYLuDxAI?e@MWASBcElAq@LsCZc@HaOfBoOlByB^??yB`@uE|@qBFqA@{AOu@Qo@]iAi@o@a@o@i@k@i@q@u@a@k@]m@c@{@Sc@Uq@_@qAm@wDCSo@sD??G_@Mm@Ge@IeACq@Ac@Ay@AkDAeDEmAMqAI_@Ia@I[Oc@i@iAU]_@_@SO}@g@IAIC{@CaB?uABcAEy@GiAMuAWYGc@KqDu@yHiAgBYO?_AM}@KyA[}@Ui@QmA]kA_@cA_@aA[}Am@??SI]KoBq@_AYoDcAeBc@mASwAOoBEs@?kCL}BDqC@cCFeA@_A@u@Dw@DmADiAF[@sBPyAF??u@DSByAPeAT}@V]Nk@Tm@X_@RcAv@WNo@r@]b@{DtF[h@}A|Bq@hAUZ}B|Cm@d@m@\\\\{@XY@MC_@QqBq@{F_C??g@ScnAl@??qCBie@i[y@c@m@QYIu@Gc@?i@DiARm@TQNa@f@uDbNIX??k@hBq@jBs@vBk@bA_JrQUj@??aDfI??[v@Wn@w@pBa@`Aa@fAwBtFc@~@k@hAsCxDwJ~N]|@Mb@K^CFKn@Gb@C\\\\ATCjAEt@GhBEbA??AXGlAAPM`DYjIM|CO|GM|DG|AGxCa@`MUbHs@fJOfD??ATIrB_Ap^s@jRWlJYdHOhGIpBKjAk@bBe@bAaDnGkBzD??m@pAwMpVgArCsBdGkEbPc@nAYb@a@d@eChDwG|HMPEFwCzNK^KVMJIB_@?iAO??kAOmB]gBGm@A[HSL[^a@|@e@fAo@r@iBh@aB^}@BkAGaNq@am@iDQ???sMUyQ~@uCJsBDo@Pc@Xm@l@m@bAaAvBu@pB]hAOx@UdAKr@??i@dD_@lDKlBOpCQjESvHKtEYbJg@rUGjCRnDFv@NbAPjAHRHLLFt@Nt@Vt@j@f@|@Vt@@DR~B@b@HpAFxN","priority":2},"id":"931_0010","links":{"self":"/shapes/931_0010"},"relationships":{"route":{"data":{"id":"Red","type":"route"}},"stops":{"data":[{"id":"place-asmnl","type":"stop"},{"id":"place-smmnl","type":"stop"},{"id":"place-fldcr","type":"stop"},{"id":"place-shmnl","type":"stop"},{"id":"place-jfk","type":"stop"},{"id":"place-andrw","type":"stop"},{"id":"place-brdwy","type":"stop"},{"id":"place-sstat","type":"stop"},{"id":"place-dwnxg","type":"stop"},{"id":"place-pktrm","type":"stop"},{"id":"place-chmnl","type":"stop"},{"id":"place-knncl","type":"stop"},{"id":"place-cntsq","type":"stop"},{"id":"place-harsq","type":"stop"},{"id":"place-portr","type":"stop"},{"id":"place-davis","type":"stop"},{"id":"place-alfcl","type":"stop"}]}},"type":"shape"},{"attributes":{"direction_id":0,"name":"Braintree","polyline":"}nwaG~|eqLGyNIqAAc@S_CAEWu@g@}@u@k@u@Wu@OMGIMISQkAOcAGw@SoDFkCf@sUXcJJuERwHPkENqCJmB^mDn@}D??D[TeANy@\\\\iAt@qB`AwBl@cAl@m@b@Yn@QrBEtCKxQ_ApMT??R?`m@hD`Np@jAF|@C`B_@hBi@n@s@d@gA`@}@Z_@RMZIl@@fBFlB\\\\tAP??~@L^?HCLKJWJ_@vC{NDGLQvG}HdCiD`@e@Xc@b@oAjEcPrBeGfAsCvMqVl@sA??jByD`DoGd@cAj@cBJkAHqBNiGXeHVmJr@kR~@q^HsB@U??NgDr@gJTcH`@aMFyCF}AL}DN}GL}CXkILaD@QFmA@[??DaAFiBDu@BkA@UB]Fc@Jo@BGJ_@Lc@\\\\}@vJ_OrCyDj@iAb@_AvBuF`@gA`@aAv@qBVo@Xu@??bDgI??Tm@~IsQj@cAr@wBp@kBj@kB??HWtDcN`@g@POl@UhASh@Eb@?t@FXHl@Px@b@he@h[pCC??bnAm@h@T??xF|BpBp@^PLBXAz@Yl@]l@e@|B}CT[p@iA|A}BZi@jBeDnAiBz@iAf@k@l@g@dAs@fAe@|@WpCe@l@GTCRE\\\\G??~@O`@ELA|AGf@A\\\\CjCGrEKz@AdEAxHY|BD~@JjB^fF~AdDbA|InCxCv@zD|@rWfEXDpB`@tANvAHx@AjBIx@M~@S~@a@fAi@HEnA{@fA{@|HuI|DwEbDqDpLkNhCyClEiFhLaN`@c@f@o@RURUbDsDbAiA`AgAv@_AHKHI~E}FdBoBfAgAfD{DxDoE~DcF|BkClAwALODEJOJK|@gATWvAoA`Au@fAs@hAk@n@QpAa@vDeAhA[x@Yh@Wv@a@b@YfAaAjCgCz@aAtByBz@{@??|FaGtCaDbL{LhI{IzHgJdAuAjC{CVYvAwA??JIl@a@NMNM\\\\[|AuArF_GlPyQrD_ErAwAd@e@nE{ErDuD\\\\a@nE_FZYPSRUvL{Mv@}@Z[JILKv@m@z@i@fCkAlBmAl@[t@[??h@WxBeAp@]dAi@p@YXIPEXKDALENEbAQl@Gz@ChADtAL~ARnCZbGx@xB`@TDL@PBzAVjIvA^FVDVB|@NjHlAlPnCnCd@vBXhBNv@JtAPL@|BXrAN??`@FRBj@Bp@FbADz@?dAIp@I|@Mx@Q`AWhAYlBs@pDaBzAs@nBgAZQJGJGhAs@RKVMNKTMf@YdHcEzBmApAw@`GmDLI@AHGlEwClAi@hA_@v@Up@ObB]z@Kr@Ir@EZCpA?dCRf@DpAHvANrE`@bDTr@DfMdA`CJvBRn@DnCLnBPfAFV@","priority":1},"id":"933_0009","links":{"self":"/shapes/933_0009"},"relationships":{"route":{"data":{"id":"Red","type":"route"}},"stops":{"data":[{"id":"place-alfcl","type":"stop"},{"id":"place-davis","type":"stop"},{"id":"place-portr","type":"stop"},{"id":"place-harsq","type":"stop"},{"id":"place-cntsq","type":"stop"},{"id":"place-knncl","type":"stop"},{"id":"place-chmnl","type":"stop"},{"id":"place-pktrm","type":"stop"},{"id":"place-dwnxg","type":"stop"},{"id":"place-sstat","type":"stop"},{"id":"place-brdwy","type":"stop"},{"id":"place-andrw","type":"stop"},{"id":"place-jfk","type":"stop"},{"id":"place-nqncy","type":"stop"},{"id":"place-qnctr","type":"stop"},{"id":"place-qamnl","type":"stop"},{"id":"place-brntn","type":"stop"}]}},"type":"shape"},{"attributes":{"direction_id":1,"name":"Braintree","polyline":"iyr`GzmjpLWAgAGoBQoCMo@EwBSaCKgMeAs@EcDUsEa@wAOqAIg@EeCSqA?[Bs@Ds@H{@JcB\\\\q@Nw@TiA^mAh@mEvCIFA@MHaGlDqAv@{BlAeHbEg@XULOJWLSJiAr@KFKF[PoBfA{Ar@qD`BmBr@iAXaAVy@P}@Lq@HeAH{@?cAEq@Gk@CSCc@G??qAO}BYMAuAQw@KiBOwBYoCe@mPoCkHmA}@OWCWE_@GkIwA{AWQCMAUEyBa@cGy@oC[_BSuAMiAE{@Bm@FcAPODMDE@YJQDYHq@XeAh@q@\\\\yBdAi@T??u@\\\\m@ZmBlAgCjA{@h@w@l@MJKH[Zw@|@wLzMSTQR[XoE~E]`@sDtDoEzEe@d@sAvAsD~DmPxQsF~F}AtA]ZOLOLm@`@IF??yAxAWXkCzCeAtA{HfJiIzIcLzLuC`D}F`G??{@z@uBxB{@`AkCfCgA`Ac@Xw@`@i@Vy@XiAZwDdAqA`@o@PiAj@gAr@aAt@wAnAUV}@fAKJKNEDMNmAvA}BjC_EbFyDnEgDzDgAfAeBnB_F|FIHIJw@~@aAfAcAhAcDrDSTSTg@n@a@b@iL`NmEhFiCxCqLjNcDpD}DvE}HtIgAz@oAz@IDgAh@_A`@_ARy@LkBHy@@wAIuAOqBa@YEsWgE{D}@yCw@}IoCeDcAgF_BkB_@_AK}BEyHXeE@{@@sEJkCF]Bg@@}AFM@a@D_AN??]FSDUBm@FqCd@}@VgAd@eAr@m@f@g@j@{@hAoAhBkBdD[h@}A|Bq@hAUZ}B|Cm@d@m@\\\\{@XY@MC_@QqBq@{F_C??g@ScnAl@??qCBie@i[y@c@m@QYIu@Gc@?i@DiARm@TQNa@f@uDbNIX??k@hBq@jBs@vBk@bA_JrQUj@??aDfI??[v@Wn@w@pBa@`Aa@fAwBtFc@~@k@hAsCxDwJ~N]|@Mb@K^CFKn@Gb@C\\\\ATCjAEt@GhBEbA??AXGlAAPM`DYjIM|CO|GM|DG|AGxCa@`MUbHs@fJOfD??ATIrB_Ap^s@jRWlJYdHOhGIpBKjAk@bBe@bAaDnGkBzD??m@pAwMpVgArCsBdGkEbPc@nAYb@a@d@eChDwG|HMPEFwCzNK^KVMJIB_@?iAO??kAOmB]gBGm@A[HSL[^a@|@e@fAo@r@iBh@aB^}@BkAGaNq@am@iDQ???sMUyQ~@uCJsBDo@Pc@Xm@l@m@bAaAvBu@pB]hAOx@UdAKr@??i@dD_@lDKlBOpCQjESvHKtEYbJg@rUGjCRnDFv@NbAPjAHRHLLFt@Nt@Vt@j@f@|@Vt@@DR~B@b@HpAFxN","priority":1},"id":"933_0010","links":{"self":"/shapes/933_0010"},"relationships":{"route":{"data":{"id":"Red","type":"route"}},"stops":{"data":[{"id":"place-brntn","type":"stop"},{"id":"place-qamnl","type":"stop"},{"id":"place-qnctr","type":"stop"},{"id":"place-nqncy","type":"stop"},{"id":"place-jfk","type":"stop"},{"id":"place-andrw","type":"stop"},{"id":"place-brdwy","type":"stop"},{"id":"place-sstat","type":"stop"},{"id":"place-dwnxg","type":"stop"},{"id":"place-pktrm","type":"stop"},{"id":"place-chmnl","type":"stop"},{"id":"place-knncl","type":"stop"},{"id":"place-cntsq","type":"stop"},{"id":"place-harsq","type":"stop"},{"id":"place-portr","type":"stop"},{"id":"place-davis","type":"stop"},{"id":"place-alfcl","type":"stop"}]}},"type":"shape"}],"jsonapi":{"version":"1.0"}}
                """
                Mbta.Decode.shape
            ]

        -- Stops
        , describe "stop"
            [ testOne
                "bus stop"
                "/stops/1"
                """
                {"data":{"attributes":{"address":null,"description":null,"latitude":42.330957,"location_type":0,"longitude":-71.082754,"name":"Washington St opp Ruggles St","platform_code":null,"platform_name":null,"wheelchair_boarding":1},"id":"1","links":{"self":"/stops/1"},"relationships":{"child_stops":{},"facilities":{"links":{"related":"/facilities/?filter[stop]=1"}},"parent_station":{"data":null},"recommended_transfers":{},"zone":{"data":null}},"type":"stop"},"jsonapi":{"version":"1.0"}}
                """
                Mbta.Decode.stop
            , testOne
                "subway child stop"
                "/stops/70070"
                """
                {"data":{"attributes":{"address":null,"description":"Central - Red Line - Alewife","latitude":42.365379,"location_type":0,"longitude":-71.103554,"name":"Central","platform_code":null,"platform_name":"Alewife","wheelchair_boarding":1},"id":"70070","links":{"self":"/stops/70070"},"relationships":{"child_stops":{},"facilities":{"links":{"related":"/facilities/?filter[stop]=70070"}},"parent_station":{"data":{"id":"place-cntsq","type":"stop"}},"recommended_transfers":{},"zone":{"data":null}},"type":"stop"},"jsonapi":{"version":"1.0"}}
                """
                Mbta.Decode.stop
            , testOne
                "subway parent stop"
                "/stops/place-cntsq"
                """
                {"data":{"attributes":{"address":"Massachusetts Avenue and Prospect Street, Cambridge, MA 02139","description":null,"latitude":42.365486,"location_type":1,"longitude":-71.103802,"name":"Central","platform_code":null,"platform_name":null,"wheelchair_boarding":1},"id":"place-cntsq","links":{"self":"/stops/place-cntsq"},"relationships":{"child_stops":{},"facilities":{"links":{"related":"/facilities/?filter[stop]=place-cntsq"}},"parent_station":{"data":null},"recommended_transfers":{},"zone":{"data":null}},"type":"stop"},"jsonapi":{"version":"1.0"}}
                """
                Mbta.Decode.stop
            , testOne
                "entrance"
                "/stops/door-cntsq-pearl"
                """
                {"data":{"attributes":{"address":null,"description":"Central - Pearl St","latitude":42.364831,"location_type":2,"longitude":-71.102989,"name":"Central - Pearl St","platform_code":null,"platform_name":null,"wheelchair_boarding":2},"id":"door-cntsq-pearl","links":{"self":"/stops/door-cntsq-pearl"},"relationships":{"child_stops":{},"facilities":{"links":{"related":"/facilities/?filter[stop]=door-cntsq-pearl"}},"parent_station":{"data":{"id":"place-cntsq","type":"stop"}},"recommended_transfers":{},"zone":{"data":null}},"type":"stop"},"jsonapi":{"version":"1.0"}}
                """
                Mbta.Decode.stop
            , testOne
                "parent with children included"
                "/stops/place-cntsq?include=child_stops"
                """
                {"data":{"attributes":{"address":"Massachusetts Avenue and Prospect Street, Cambridge, MA 02139","description":null,"latitude":42.365486,"location_type":1,"longitude":-71.103802,"name":"Central","platform_code":null,"platform_name":null,"wheelchair_boarding":1},"id":"place-cntsq","links":{"self":"/stops/place-cntsq"},"relationships":{"child_stops":{"data":[{"id":"70069","type":"stop"},{"id":"70070","type":"stop"},{"id":"door-cntsq-essex","type":"stop"},{"id":"door-cntsq-ibmass","type":"stop"},{"id":"door-cntsq-obmass","type":"stop"},{"id":"door-cntsq-pearl","type":"stop"},{"id":"door-cntsq-prospect","type":"stop"},{"id":"door-cntsq-western","type":"stop"}]},"facilities":{"links":{"related":"/facilities/?filter[stop]=place-cntsq"}},"parent_station":{"data":null},"recommended_transfers":{},"zone":{"data":null}},"type":"stop"},"included":[{"attributes":{"address":null,"description":"Central - Red Line - Ashmont/Braintree","latitude":42.365304,"location_type":0,"longitude":-71.103621,"name":"Central","platform_code":null,"platform_name":"Ashmont/Braintree","wheelchair_boarding":1},"id":"70069","links":{"self":"/stops/70069"},"relationships":{"child_stops":{},"facilities":{"links":{"related":"/facilities/?filter[stop]=70069"}},"parent_station":{"data":{"id":"place-cntsq","type":"stop"}},"recommended_transfers":{},"zone":{"data":null}},"type":"stop"},{"attributes":{"address":null,"description":"Central - Red Line - Alewife","latitude":42.365379,"location_type":0,"longitude":-71.103554,"name":"Central","platform_code":null,"platform_name":"Alewife","wheelchair_boarding":1},"id":"70070","links":{"self":"/stops/70070"},"relationships":{"child_stops":{},"facilities":{"links":{"related":"/facilities/?filter[stop]=70070"}},"parent_station":{"data":{"id":"place-cntsq","type":"stop"}},"recommended_transfers":{},"zone":{"data":null}},"type":"stop"},{"attributes":{"address":null,"description":"Central - Essex St","latitude":42.364991,"location_type":2,"longitude":-71.102811,"name":"Central - Essex St","platform_code":null,"platform_name":null,"wheelchair_boarding":2},"id":"door-cntsq-essex","links":{"self":"/stops/door-cntsq-essex"},"relationships":{"child_stops":{},"facilities":{"links":{"related":"/facilities/?filter[stop]=door-cntsq-essex"}},"parent_station":{"data":{"id":"place-cntsq","type":"stop"}},"recommended_transfers":{},"zone":{"data":null}},"type":"stop"},{"attributes":{"address":null,"description":"Central - Mass Ave","latitude":42.36519,"location_type":2,"longitude":-71.103557,"name":"Central - Mass Ave","platform_code":null,"platform_name":null,"wheelchair_boarding":1},"id":"door-cntsq-ibmass","links":{"self":"/stops/door-cntsq-ibmass"},"relationships":{"child_stops":{},"facilities":{"links":{"related":"/facilities/?filter[stop]=door-cntsq-ibmass"}},"parent_station":{"data":{"id":"place-cntsq","type":"stop"}},"recommended_transfers":{},"zone":{"data":null}},"type":"stop"},{"attributes":{"address":null,"description":"Central - Mass Ave","latitude":42.365541,"location_type":2,"longitude":-71.103749,"name":"Central - Mass Ave","platform_code":null,"platform_name":null,"wheelchair_boarding":1},"id":"door-cntsq-obmass","links":{"self":"/stops/door-cntsq-obmass"},"relationships":{"child_stops":{},"facilities":{"links":{"related":"/facilities/?filter[stop]=door-cntsq-obmass"}},"parent_station":{"data":{"id":"place-cntsq","type":"stop"}},"recommended_transfers":{},"zone":{"data":null}},"type":"stop"},{"attributes":{"address":null,"description":"Central - Pearl St","latitude":42.364831,"location_type":2,"longitude":-71.102989,"name":"Central - Pearl St","platform_code":null,"platform_name":null,"wheelchair_boarding":2},"id":"door-cntsq-pearl","links":{"self":"/stops/door-cntsq-pearl"},"relationships":{"child_stops":{},"facilities":{"links":{"related":"/facilities/?filter[stop]=door-cntsq-pearl"}},"parent_station":{"data":{"id":"place-cntsq","type":"stop"}},"recommended_transfers":{},"zone":{"data":null}},"type":"stop"},{"attributes":{"address":null,"description":"Central - Prospect St","latitude":42.365778,"location_type":2,"longitude":-71.104131,"name":"Central - Prospect St","platform_code":null,"platform_name":null,"wheelchair_boarding":2},"id":"door-cntsq-prospect","links":{"self":"/stops/door-cntsq-prospect"},"relationships":{"child_stops":{},"facilities":{"links":{"related":"/facilities/?filter[stop]=door-cntsq-prospect"}},"parent_station":{"data":{"id":"place-cntsq","type":"stop"}},"recommended_transfers":{},"zone":{"data":null}},"type":"stop"},{"attributes":{"address":null,"description":"Central - Western Ave","latitude":42.365635,"location_type":2,"longitude":-71.104304,"name":"Central - Western Ave","platform_code":null,"platform_name":null,"wheelchair_boarding":2},"id":"door-cntsq-western","links":{"self":"/stops/door-cntsq-western"},"relationships":{"child_stops":{},"facilities":{"links":{"related":"/facilities/?filter[stop]=door-cntsq-western"}},"parent_station":{"data":{"id":"place-cntsq","type":"stop"}},"recommended_transfers":{},"zone":{"data":null}},"type":"stop"}],"jsonapi":{"version":"1.0"}}
                """
                Mbta.Decode.stop
            , testMany
                "multiple"
                "/stops?filter[route]=746"
                """
                {"data":[{"attributes":{"address":"Silver Line Way and Starboard Way, Boston, MA 02210","description":"Silver Line Way before Manulife Building - Silver Line - South Station","latitude":42.347188,"location_type":0,"longitude":-71.038846,"name":"Silver Line Way before Manulife Building","platform_code":null,"platform_name":"South Station","wheelchair_boarding":1},"id":"74614","links":{"self":"/stops/74614"},"relationships":{"child_stops":{},"facilities":{"links":{"related":"/facilities/?filter[stop]=74614"}},"parent_station":{"data":null},"recommended_transfers":{},"zone":{"data":null}},"type":"stop"},{"attributes":{"address":"Congress St and World Trade Center Ave, Boston, MA","description":null,"latitude":42.34863,"location_type":1,"longitude":-71.04246,"name":"World Trade Center","platform_code":null,"platform_name":null,"wheelchair_boarding":1},"id":"place-wtcst","links":{"self":"/stops/place-wtcst"},"relationships":{"child_stops":{},"facilities":{"links":{"related":"/facilities/?filter[stop]=place-wtcst"}},"parent_station":{"data":null},"recommended_transfers":{},"zone":{"data":null}},"type":"stop"},{"attributes":{"address":"Seaport Blvd and Pittsburg St, Boston, MA","description":null,"latitude":42.35245,"location_type":1,"longitude":-71.04685,"name":"Courthouse","platform_code":null,"platform_name":null,"wheelchair_boarding":1},"id":"place-crtst","links":{"self":"/stops/place-crtst"},"relationships":{"child_stops":{},"facilities":{"links":{"related":"/facilities/?filter[stop]=place-crtst"}},"parent_station":{"data":null},"recommended_transfers":{},"zone":{"data":null}},"type":"stop"},{"attributes":{"address":"700 Atlantic Ave, Boston, MA 02110","description":null,"latitude":42.352271,"location_type":1,"longitude":-71.055242,"name":"South Station","platform_code":null,"platform_name":null,"wheelchair_boarding":1},"id":"place-sstat","links":{"self":"/stops/place-sstat"},"relationships":{"child_stops":{},"facilities":{"links":{"related":"/facilities/?filter[stop]=place-sstat"}},"parent_station":{"data":null},"recommended_transfers":{},"zone":{"data":{"id":"CR-zone-1A","type":"zone"}}},"type":"stop"},{"attributes":{"address":"Silver Line Way and Starboard Way, Boston, MA 02210","description":"Silver Line Way after Manulife Building - Silver Line - Airport/Design Center/Chelsea","latitude":42.347056,"location_type":0,"longitude":-71.038814,"name":"Silver Line Way after Manulife Building","platform_code":null,"platform_name":"Airport/Design Center/Chelsea","wheelchair_boarding":1},"id":"74624","links":{"self":"/stops/74624"},"relationships":{"child_stops":{},"facilities":{"links":{"related":"/facilities/?filter[stop]=74624"}},"parent_station":{"data":null},"recommended_transfers":{},"zone":{"data":null}},"type":"stop"}],"jsonapi":{"version":"1.0"}}
                """
                Mbta.Decode.stop
            ]
        , describe "facilities"
            [ testOne
                "BIKE_STORAGE"
                "https://api-v3.mbta.com/facilities/bike-15095"
                """
                {"data":{"attributes":{"latitude":null,"longitude":null,"name":"Washington St @ Herald St bike rack","properties":[{"name":"capacity","value":2},{"name":"enclosed","value":2},{"name":"secured","value":2}],"type":"BIKE_STORAGE"},"id":"bike-15095","links":{"self":"/facilities/bike-15095"},"relationships":{"stop":{"data":{"id":"15095","type":"stop"}}},"type":"facility"},"jsonapi":{"version":"1.0"}}
                """
                Mbta.Decode.facility
            , testOne
                "ELECTRIC_CAR_CHARGERS"
                "https://api-v3.mbta.com/facilities/ev-ER-0168-garage"
                """
                {"data":{"attributes":{"latitude":null,"longitude":null,"name":"Salem Garage EV Chargers","properties":[{"name":"capacity","value":4}],"type":"ELECTRIC_CAR_CHARGERS"},"id":"ev-ER-0168-garage","links":{"self":"/facilities/ev-ER-0168-garage"},"relationships":{"stop":{"data":{"id":"Salem","type":"stop"}}},"type":"facility"},"jsonapi":{"version":"1.0"}}
                """
                Mbta.Decode.facility
            , testOne
                "ELEVATOR"
                "https://api-v3.mbta.com/facilities/990"
                """
                {"data":{"attributes":{"latitude":null,"longitude":null,"name":"Lansdowne Elevator 990 (Street to South Station platform 2 and bridge)","properties":[],"type":"ELEVATOR"},"id":"990","links":{"self":"/facilities/990"},"relationships":{"stop":{"data":{"id":"Yawkey","type":"stop"}}},"type":"facility"},"jsonapi":{"version":"1.0"}}
                """
                Mbta.Decode.facility
            , testOne
                "ESCALATOR"
                "https://api-v3.mbta.com/facilities/382"
                """
                {"data":{"attributes":{"latitude":null,"longitude":null,"name":"South Station Escalator 382 (Alewife platform to lobby)","properties":[{"name":"direction","value":"up"},{"name":"excludes-stop","value":70079},{"name":"excludes-stop","value":"South Station"},{"name":"excludes-stop","value":"South Station-01"},{"name":"excludes-stop","value":"South Station-02"},{"name":"excludes-stop","value":"South Station-03"},{"name":"excludes-stop","value":"South Station-04"},{"name":"excludes-stop","value":"South Station-05"},{"name":"excludes-stop","value":"South Station-06"},{"name":"excludes-stop","value":"South Station-07"},{"name":"excludes-stop","value":"South Station-08"},{"name":"excludes-stop","value":"South Station-09"},{"name":"excludes-stop","value":"South Station-10"},{"name":"excludes-stop","value":"South Station-11"},{"name":"excludes-stop","value":"South Station-12"},{"name":"excludes-stop","value":"South Station-13"},{"name":"excludes-stop","value":"door-sstat-atlantic"},{"name":"excludes-stop","value":"door-sstat-bus"},{"name":"excludes-stop","value":"door-sstat-dewey"},{"name":"excludes-stop","value":"door-sstat-finctr"},{"name":"excludes-stop","value":"door-sstat-main"},{"name":"excludes-stop","value":"door-sstat-outmain"},{"name":"excludes-stop","value":"door-sstat-reserve"},{"name":"excludes-stop","value":"door-sstat-summer"},{"name":"excludes-stop","value":"door-sstat-usps"},{"name":"excludes-stop","value":"node-382-lobby"},{"name":"excludes-stop","value":"node-382-rl"},{"name":"excludes-stop","value":"node-386-lobby"},{"name":"excludes-stop","value":"node-387-lobby"},{"name":"excludes-stop","value":"node-388-lobby"},{"name":"excludes-stop","value":"node-388-sl"},{"name":"excludes-stop","value":"node-389-lobby"},{"name":"excludes-stop","value":"node-389-rl"},{"name":"excludes-stop","value":"node-390-rl"},{"name":"excludes-stop","value":"node-390-sl"},{"name":"excludes-stop","value":"node-398-rl"},{"name":"excludes-stop","value":"node-398-sl"},{"name":"excludes-stop","value":"node-399-lobby"},{"name":"excludes-stop","value":"node-399-middle"},{"name":"excludes-stop","value":"node-400-middle"},{"name":"excludes-stop","value":"node-400-rl"},{"name":"excludes-stop","value":"node-411-lobby"},{"name":"excludes-stop","value":"node-411-sl"},{"name":"excludes-stop","value":"node-419-lobby"},{"name":"excludes-stop","value":"node-419-middle"},{"name":"excludes-stop","value":"node-420-middle"},{"name":"excludes-stop","value":"node-420-rl"},{"name":"excludes-stop","value":"node-424-lobby"},{"name":"excludes-stop","value":"node-6476-ground"},{"name":"excludes-stop","value":"node-6476-lobby"},{"name":"excludes-stop","value":"node-901-lobby"},{"name":"excludes-stop","value":"node-901-rl"},{"name":"excludes-stop","value":"node-901-sl"},{"name":"excludes-stop","value":"node-918-lobby"},{"name":"excludes-stop","value":"node-918-rl"},{"name":"excludes-stop","value":"node-918-sl"},{"name":"excludes-stop","value":"node-919-rl"},{"name":"excludes-stop","value":"node-919-sl"},{"name":"excludes-stop","value":"node-926-lobby"},{"name":"excludes-stop","value":"node-927-rl"},{"name":"excludes-stop","value":"node-927-sl"},{"name":"excludes-stop","value":"node-949-lobby"},{"name":"excludes-stop","value":"node-sstat-382stair-lobby"},{"name":"excludes-stop","value":"node-sstat-382stair-rl"},{"name":"excludes-stop","value":"node-sstat-388stair-lobby"},{"name":"excludes-stop","value":"node-sstat-388stair-sl"},{"name":"excludes-stop","value":"node-sstat-389stair-lobby"},{"name":"excludes-stop","value":"node-sstat-389stair-rl"},{"name":"excludes-stop","value":"node-sstat-390stair-rl"},{"name":"excludes-stop","value":"node-sstat-390stair-sl"},{"name":"excludes-stop","value":"node-sstat-398stair-rl"},{"name":"excludes-stop","value":"node-sstat-398stair-sl"},{"name":"excludes-stop","value":"node-sstat-399stair-lobby"},{"name":"excludes-stop","value":"node-sstat-399stair-middle"},{"name":"excludes-stop","value":"node-sstat-400sl-middle"},{"name":"excludes-stop","value":"node-sstat-400sl-sl"},{"name":"excludes-stop","value":"node-sstat-400stair-middle"},{"name":"excludes-stop","value":"node-sstat-400stair-rl"},{"name":"excludes-stop","value":"node-sstat-411stair-lobby"},{"name":"excludes-stop","value":"node-sstat-411stair-sl"},{"name":"excludes-stop","value":"node-sstat-419stair-lobby"},{"name":"excludes-stop","value":"node-sstat-419stair-middle"},{"name":"excludes-stop","value":"node-sstat-420sl-middle"},{"name":"excludes-stop","value":"node-sstat-420sl-sl"},{"name":"excludes-stop","value":"node-sstat-420stair-middle"},{"name":"excludes-stop","value":"node-sstat-420stair-rl"},{"name":"excludes-stop","value":"node-sstat-918stair-lobby"},{"name":"excludes-stop","value":"node-sstat-918stair-sl"},{"name":"excludes-stop","value":"node-sstat-919stair-rl"},{"name":"excludes-stop","value":"node-sstat-919stair-sl"},{"name":"excludes-stop","value":"node-sstat-alewife-farepaid"},{"name":"excludes-stop","value":"node-sstat-alewife-fareunpaid"},{"name":"excludes-stop","value":"node-sstat-ashbrain-farepaid"},{"name":"excludes-stop","value":"node-sstat-ashbrain-fareunpaid"},{"name":"excludes-stop","value":"node-sstat-bldgescdown-ground"},{"name":"excludes-stop","value":"node-sstat-bldgescdown-lobby"},{"name":"excludes-stop","value":"node-sstat-bldgescup-ground"},{"name":"excludes-stop","value":"node-sstat-bldgescup-lobby"},{"name":"excludes-stop","value":"node-sstat-bldgstair-ground"},{"name":"excludes-stop","value":"node-sstat-bldgstair-lobby"},{"name":"excludes-stop","value":"node-sstat-cr-lobby"},{"name":"excludes-stop","value":"node-sstat-deweystair-lobby"},{"name":"excludes-stop","value":"node-sstat-finctrstair-lobby"},{"name":"excludes-stop","value":"node-sstat-north-farepaid"},{"name":"excludes-stop","value":"node-sstat-north-fareunpaid"},{"name":"excludes-stop","value":"node-sstat-outmainstair-lobby"},{"name":"excludes-stop","value":"node-sstat-reservestair-lobby"},{"name":"excludes-stop","value":"node-sstat-south-farepaid"},{"name":"excludes-stop","value":"node-sstat-south-fareunpaid"}],"type":"ESCALATOR"},"id":"382","links":{"self":"/facilities/382"},"relationships":{"stop":{"data":{"id":"place-sstat","type":"stop"}}},"type":"facility"},"jsonapi":{"version":"1.0"}}
                """
                Mbta.Decode.facility
            , testOne
                "PARKING_AREA"
                "https://api-v3.mbta.com/facilities/park-900"
                """
                {"data":{"attributes":{"latitude":42.363172,"longitude":-71.184674,"name":"Watertown Yard Parking Lot","properties":[{"name":"attended","value":2},{"name":"capacity","value":200},{"name":"capacity-accessible","value":6},{"name":"contact","value":"MBTA Customer Support"},{"name":"contact-phone","value":"617-222-3200"},{"name":"contact-url","value":"http://www.parkmbta.com/"},{"name":"enclosed","value":2},{"name":"fee-daily","value":"Mon-Fri: $2.50 | Sat-Sun: $2.50"},{"name":"fee-monthly","value":"$43.75"},{"name":"municipality","value":"Watertown"},{"name":"operator","value":"Republic Parking System"},{"name":"owner","value":"MBTA"},{"name":"payment-app","value":"PayByPhone"},{"name":"payment-app-id","value":4259},{"name":"payment-app-url","value":"https://www.paybyphone.com/"},{"name":"payment-form-accepted","value":"invoice"},{"name":"payment-form-accepted","value":"mobile-app"},{"name":"weekday-typical-utilization","value":129},{"name":"weekday-utilization-summary","value":"Utilization never crosses 90% of capacity"}],"type":"PARKING_AREA"},"id":"park-900","links":{"self":"/facilities/park-900"},"relationships":{"stop":{"data":{"id":"900","type":"stop"}}},"type":"facility"},"jsonapi":{"version":"1.0"}}
                """
                Mbta.Decode.facility
            , testOne
                "PICK_DROP"
                "https://api-v3.mbta.com/facilities/pick-alfcl-garage"
                """
                {"data":{"attributes":{"latitude":42.395598,"longitude":-71.141842,"name":"Alewife Garage Pick-up/Drop-off","properties":[],"type":"PICK_DROP"},"id":"pick-alfcl-garage","links":{"self":"/facilities/pick-alfcl-garage"},"relationships":{"stop":{"data":{"id":"place-alfcl","type":"stop"}}},"type":"facility"},"jsonapi":{"version":"1.0"}}
                """
                Mbta.Decode.facility
            , testOne
                "PORTABLE_BOARDING_LIFT"
                "https://api-v3.mbta.com/facilities/portlift-armnl-0"
                """
                {"data":{"attributes":{"latitude":null,"longitude":null,"name":"Arlington mobile lift (Park Street & North)","properties":[{"name":"excludes-stop","value":70157},{"name":"note","value":"Significant barriers exist at station, but customers may be able to board/exit train using mobile lift"}],"type":"PORTABLE_BOARDING_LIFT"},"id":"portlift-armnl-0","links":{"self":"/facilities/portlift-armnl-0"},"relationships":{"stop":{"data":{"id":"place-armnl","type":"stop"}}},"type":"facility"},"jsonapi":{"version":"1.0"}}
                """
                Mbta.Decode.facility
            , testOne
                "ELEVATED_SUBPLATFORM"
                "https://api-v3.mbta.com/facilities/subplat-025"
                """
                {"data":{"attributes":{"latitude":null,"longitude":null,"name":"Ipswich mini-high platform","properties":[{"name":"note","value":"Mini high level platform is available to provide level boarding to certain cars in a train set"}],"type":"ELEVATED_SUBPLATFORM"},"id":"subplat-025","links":{"self":"/facilities/subplat-025"},"relationships":{"stop":{"data":{"id":"Ipswich","type":"stop"}}},"type":"facility"},"jsonapi":{"version":"1.0"}}
                """
                Mbta.Decode.facility
            , testOne
                "with includes"
                "https://api-v3.mbta.com/facilities/subplat-025?include=stop"
                """
                {"data":{"attributes":{"latitude":null,"longitude":null,"name":"Ipswich mini-high platform","properties":[{"name":"note","value":"Mini high level platform is available to provide level boarding to certain cars in a train set"}],"type":"ELEVATED_SUBPLATFORM"},"id":"subplat-025","links":{"self":"/facilities/subplat-025"},"relationships":{"stop":{"data":{"id":"Ipswich","type":"stop"}}},"type":"facility"},"included":[{"attributes":{"address":"4 Peatfield St, Ipswich, MA 01938","description":null,"latitude":42.676921,"location_type":0,"longitude":-70.840589,"name":"Ipswich","platform_code":null,"platform_name":null,"wheelchair_boarding":1},"id":"Ipswich","links":{"self":"/stops/Ipswich"},"relationships":{"child_stops":{},"facilities":{"links":{"related":"/facilities/?filter[stop]=Ipswich"}},"parent_station":{"data":null},"recommended_transfers":{},"zone":{"data":{"id":"CR-zone-6","type":"zone"}}},"type":"stop"}],"jsonapi":{"version":"1.0"}}
                """
                Mbta.Decode.facility
            , testMany
                "multiple"
                "https://api-v3.mbta.com/facilities?filter[stop]=Anderson%2F%20Woburn"
                """
                {"data":[{"attributes":{"latitude":42.517377,"longitude":-71.144055,"name":"Anderson/Woburn fare vending machine 202213","properties":[{"name":"enclosed","value":1},{"name":"payment-form-accepted","value":"credit-debit-card"}],"type":"FARE_VENDING_MACHINE"},"id":"fvm-202213","links":{"self":"/facilities/fvm-202213"},"relationships":{"stop":{"data":{"id":"Anderson/ Woburn","type":"stop"}}},"type":"facility"},{"attributes":{"latitude":null,"longitude":null,"name":"Anderson/Woburn high-level platform","properties":[{"name":"note","value":"Full high level platform is available to provide level boarding to every car in a train set"}],"type":"FULLY_ELEVATED_PLATFORM"},"id":"highlevel-NHRML-0127","links":{"self":"/facilities/highlevel-NHRML-0127"},"relationships":{"stop":{"data":{"id":"Anderson/ Woburn","type":"stop"}}},"type":"facility"},{"attributes":{"latitude":42.516512,"longitude":-71.142813,"name":"Anderson/Woburn Logan Express Parking Lot","properties":[{"name":"attended","value":1},{"name":"capacity","value":880},{"name":"contact","value":"Massport"},{"name":"contact-phone","value":"781-721-0373"},{"name":"contact-url","value":"http://www.massport.com/logan-airport/to-from-logan/transportation-options/logan-express/woburn/"},{"name":"enclosed","value":2},{"name":"fee-daily","value":"$7 overnight"},{"name":"municipality","value":"Woburn"},{"name":"note","value":"Massport is responsible for parking maintenance, payments, and snow removal."},{"name":"operator","value":"Massport"},{"name":"owner","value":"Local transit authority"},{"name":"payment-form-accepted","value":"cash"},{"name":"payment-form-accepted","value":"credit-debit-card"}],"type":"PARKING_AREA"},"id":"park-NHRML-0127-airport","links":{"self":"/facilities/park-NHRML-0127-airport"},"relationships":{"stop":{"data":{"id":"Anderson/ Woburn","type":"stop"}}},"type":"facility"},{"attributes":{"latitude":42.518544,"longitude":-71.144061,"name":"Anderson/Woburn Park and Ride Parking Lot","properties":[{"name":"attended","value":1},{"name":"capacity","value":1200},{"name":"contact","value":"Massport"},{"name":"contact-phone","value":"781-721-0373"},{"name":"contact-url","value":"https://www.lazparking.com/local/woburn-ma/anderson-regional-transportation-center"},{"name":"enclosed","value":2},{"name":"fee-daily","value":"$4"},{"name":"fee-monthly","value":"$70"},{"name":"municipality","value":"Woburn"},{"name":"note","value":"Massport is responsible for parking maintenance, payments, and snow removal."},{"name":"operator","value":"LAZ Parking"},{"name":"owner","value":"Local transit authority"},{"name":"payment-form-accepted","value":"cash"},{"name":"payment-form-accepted","value":"credit-debit-card"}],"type":"PARKING_AREA"},"id":"park-NHRML-0127-parkride","links":{"self":"/facilities/park-NHRML-0127-parkride"},"relationships":{"stop":{"data":{"id":"Anderson/ Woburn","type":"stop"}}},"type":"facility"},{"attributes":{"latitude":null,"longitude":null,"name":"Anderson/Woburn ramp access","properties":[],"type":"RAMP"},"id":"ramp-NHRML-0127","links":{"self":"/facilities/ramp-NHRML-0127"},"relationships":{"stop":{"data":{"id":"Anderson/ Woburn","type":"stop"}}},"type":"facility"},{"attributes":{"latitude":42.5173642,"longitude":-71.144242,"name":"Anderson Regional Transportation Center","properties":[{"name":"address","value":"100 Atlantic Ave, Woburn, MA 01801"},{"name":"contact-phone","value":"781-721-0373"},{"name":"dispenses","value":"fare-media"},{"name":"enclosed","value":1},{"name":"payment-form-accepted","value":"cash"},{"name":"payment-form-accepted","value":"credit-debit-card"}],"type":"FARE_VENDING_RETAILER"},"id":"retailsale-302194","links":{"self":"/facilities/retailsale-302194"},"relationships":{"stop":{"data":{"id":"Anderson/ Woburn","type":"stop"}}},"type":"facility"}],"jsonapi":{"version":"1.0"}}
                """
                Mbta.Decode.facility
            ]
        , describe "live-facilities"
            [ testOne
                "one"
                "https://api-v3.mbta.com/live-facilities/park-alfcl-garage"
                """
                {"data":{"attributes":{"properties":[{"name":"capacity","value":2312},{"name":"utilization","value":248},{"name":"status","value":null}],"updated_at":"2019-05-06T21:39:59-04:00"},"id":"park-alfcl-garage","links":{"self":"/live-facilities/park-alfcl-garage"},"relationships":{"facility":{"data":{"id":"park-alfcl-garage","type":"facility"}}},"type":"live-facility"},"jsonapi":{"version":"1.0"}}
                """
                Mbta.Decode.liveFacility
            , testOne
                "with include"
                "https://api-v3.mbta.com/live-facilities/park-alfcl-garage?include=facility"
                """
                {"data":{"attributes":{"properties":[{"name":"capacity","value":2312},{"name":"utilization","value":248},{"name":"status","value":null}],"updated_at":"2019-05-06T21:39:59-04:00"},"id":"park-alfcl-garage","links":{"self":"/live-facilities/park-alfcl-garage"},"relationships":{"facility":{"data":{"id":"park-alfcl-garage","type":"facility"}}},"type":"live-facility"},"included":[{"attributes":{"latitude":42.395428,"longitude":-71.142483,"name":"Alewife Garage","properties":[{"name":"attended","value":1},{"name":"capacity","value":2471},{"name":"capacity-accessible","value":32},{"name":"car-sharing","value":"Zipcar"},{"name":"contact","value":"MBTA Customer Support"},{"name":"contact-phone","value":"617-222-3200"},{"name":"contact-url","value":"http://www.parkmbta.com/"},{"name":"enclosed","value":1},{"name":"fee-daily","value":"Mon-Fri: $9 | Sat-Sun: $3 (Prices are valid for up to 14 hours of parking. After the first 14 hours, the daily rate is $15.)"},{"name":"fee-monthly","value":"Monthly passes are not available at MBTA garages."},{"name":"municipality","value":"Cambridge"},{"name":"operator","value":"Republic Parking System"},{"name":"owner","value":"MBTA"},{"name":"payment-form-accepted","value":"cash"},{"name":"payment-form-accepted","value":"credit-debit-card"},{"name":"payment-form-accepted","value":"tapcard"},{"name":"weekday-utilization-summary","value":"No data"}],"type":"PARKING_AREA"},"id":"park-alfcl-garage","links":{"self":"/facilities/park-alfcl-garage"},"relationships":{"stop":{"data":{"id":"place-alfcl","type":"stop"}}},"type":"facility"}],"jsonapi":{"version":"1.0"}}
                """
                Mbta.Decode.liveFacility
            , testMany
                "multiple"
                "https://api-v3.mbta.com/live-facilities?filter[id]=park-alfcl-garage,park-ER-0168-garage"
                """
                {"data":[{"attributes":{"properties":[{"name":"capacity","value":676},{"name":"utilization","value":35},{"name":"status","value":null}],"updated_at":"2019-05-06T21:44:59-04:00"},"id":"park-ER-0168-garage","links":{"self":"/live-facilities/park-ER-0168-garage"},"relationships":{"facility":{"data":{"id":"park-ER-0168-garage","type":"facility"}}},"type":"live-facility"},{"attributes":{"properties":[{"name":"capacity","value":2312},{"name":"utilization","value":246},{"name":"status","value":null}],"updated_at":"2019-05-06T21:44:59-04:00"},"id":"park-alfcl-garage","links":{"self":"/live-facilities/park-alfcl-garage"},"relationships":{"facility":{"data":{"id":"park-alfcl-garage","type":"facility"}}},"type":"live-facility"}],"jsonapi":{"version":"1.0"}}
                """
                Mbta.Decode.liveFacility
            ]
        ]
